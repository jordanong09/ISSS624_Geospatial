<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Ong Zhi Rong Jordan">
<meta name="dcterms.date" content="2022-06-25">
<title>Bringing Geographical Data to Life - RFM Model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><link rel="stylesheet" href="../../../styles.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../media/geospatial.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Bringing Geographical Data to Life</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html">About Me</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jordanong09"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries">Libraries</a></li>
  <li><a href="#data-set" id="toc-data-set" class="nav-link" data-scroll-target="#data-set">Data Set</a></li>
  <li>
<a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">Data Wrangling</a>
  <ul class="collapse">
<li><a href="#change-of-data-class" id="toc-change-of-data-class" class="nav-link" data-scroll-target="#change-of-data-class">Change of data class</a></li>
  <li><a href="#extracting-recency-frequency-and-monetary" id="toc-extracting-recency-frequency-and-monetary" class="nav-link" data-scroll-target="#extracting-recency-frequency-and-monetary">Extracting Recency, Frequency and Monetary</a></li>
  <li><a href="#examining-the-distribution-of-the-rfm-model" id="toc-examining-the-distribution-of-the-rfm-model" class="nav-link" data-scroll-target="#examining-the-distribution-of-the-rfm-model">Examining the distribution of the RFM model</a></li>
  <li><a href="#k-means-clustering" id="toc-k-means-clustering" class="nav-link" data-scroll-target="#k-means-clustering">K-means Clustering</a></li>
  <li><a href="#insights-from-cluster" id="toc-insights-from-cluster" class="nav-link" data-scroll-target="#insights-from-cluster">Insights from Cluster</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">RFM Model</h1>
<p class="subtitle lead">Leveraging on simple data wrangling techniques to create a RFM model. Subsequently, leveraging on unsupervised classification to conduct customer segmentation for targeted marketing.</p>
  <div class="quarto-categories">
    <div class="quarto-category">tibble</div>
    <div class="quarto-category">clustering</div>
    <div class="quarto-category">unsupervised</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ong Zhi Rong Jordan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 25, 2022</p>
    </div>
  </div>
    
  </div>
  

</header><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The RFM model has become essential for businesses to identify high value customers and possible churn customers to conduct targeted marketing. Businesses have leverage RFM model to better understand customer behaviours and also calculate Customer Life Time Value (LTV). This could also translate to better budgeting for marketing cost using the (3:1) ratio of LTV:CAC. In this article, I will demonstrate how we can leverage on existing libraries to conduct <strong>unsupervised</strong> classification and lastly potential future works to enhance the model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"RFM.png"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="RFM.png" class="img-fluid figure-img" width="700"></p>
</figure>
</div>
</div>
</div>
</section><section id="libraries" class="level2"><h2 class="anchored" data-anchor-id="libraries">Libraries</h2>
<p>For this analysis, we will use the following packages from CRAN.</p>
<p><a href="https://cran.r-project.org/web/packages/cluster/index.html"><code>cluster</code></a> - Methods for Cluster analysis. Much extended the original from Peter Rousseeuw, Anja Struyf and Mia Hubert, based on Kaufman and Rousseeuw (1990) “Finding Groups in Data”.<br><a href="https://www.tidyverse.org/packages/"><code>tidyverse</code></a> - Loading the core tidyverse packages which will be used for data wrangling and visualisation.<br><a href="https://cran.r-project.org/web/packages/factoextra/readme/README.html#:~:text=The%20R%20package%20factoextra%20has,data%20visualization%20with%20less%20typing."><code>factoextra</code></a> - Extract and Visualize the Results of Multivariate Data Analyses. <a href="https://ggobi.github.io/ggally/"><code>GGally</code></a> Extension of <code>ggplot2</code> by adding several functions to reduce the complexity of combining geometric objects with transformed data.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">cluster</span>, <span class="va">tidyverse</span>, <span class="va">factoextra</span>,<span class="va">lubridate</span>,<span class="va">patchwork</span>, <span class="va">GGally</span>, <span class="va">moments</span>,<span class="va">bestNormalize</span><span class="op">)</span> <span class="co">#refer to 1st post to understand the usage of pacman</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="data-set" class="level2"><h2 class="anchored" data-anchor-id="data-set">Data Set</h2>
<ul>
<li>We will use a customer data set that consist of 6 columns.
<ul>
<li>Customer_ID: Identification of Customer</li>
<li>CategoryGroup: Category group of the item purchased</li>
<li>Category: Category of the item purchased</li>
<li>InvoiceDate: The date of purchased</li>
<li>Quantity: The number of items purchased</li>
<li>TotalPrice: The total amount spend on that item</li>
</ul>
</li>
</ul></section><section id="data-wrangling" class="level2"><h2 class="anchored" data-anchor-id="data-wrangling">Data Wrangling</h2>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">customer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"data/customer.rds"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s examine the data!</p>
<p>From the summary, we can identify a few potential problems!</p>
<ul>
<li>Customer_ID is in numeric not character. # I prefer IDs to be in character form since it is for representation of customer instead of number of customers.<br>
</li>
<li>InvoiceDate is not in date time format!<br>
</li>
<li>TotalPrice is not in numeric (the symbol was attached to the number)</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span> <span class="op">(</span><span class="va">customer</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Customer_ID    CategoryGroup        Category         InvoiceDate       
 Min.   :12348   Length:395888      Length:395888      Length:395888     
 1st Qu.:14132   Class :character   Class :character   Class :character  
 Median :15535   Mode  :character   Mode  :character   Mode  :character  
 Mean   :15462                                                           
 3rd Qu.:16841                                                           
 Max.   :18287                                                           
    Quantity        TotalPrice       
 Min.   :   1.00   Length:395888     
 1st Qu.:   2.00   Class :character  
 Median :   4.00   Mode  :character  
 Mean   :   8.29                     
 3rd Qu.:  12.00                     
 Max.   :1500.00                     </code></pre>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">customer</span><span class="op">$</span><span class="va">TotalPrice</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "£8" "£2" "£1" "£3" "£3" "£5"</code></pre>
</div>
</div>
<section id="change-of-data-class" class="level3"><h3 class="anchored" data-anchor-id="change-of-data-class">Change of data class</h3>
<p>For the date time format, we will leverage on lubridate functions to convert our exisiting date to date time format. Since the format is Month/Day/Year, we will use the function <code>mdy</code>. For TotalPrice, there are two symbols found, <code>£</code> and <code>,</code>. We will use the <code>gsub</code> function and replace all symbols to an empty space. Lastly, using <code>as.numeric</code> to convert it to a numeric class. For CustomerID, simply use <code>as.character</code> to convert it to character class.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">customer</span><span class="op">$</span><span class="va">InvoiceDate</span> <span class="op">&lt;-</span> <span class="fu">mdy</span><span class="op">(</span><span class="va">customer</span><span class="op">$</span><span class="va">InvoiceDate</span><span class="op">)</span>
<span class="va">customer</span><span class="op">$</span><span class="va">TotalPrice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"[£]|[,]"</span>,<span class="st">""</span>,<span class="va">customer</span><span class="op">$</span><span class="va">TotalPrice</span>, perl<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">customer</span><span class="op">$</span><span class="va">Customer_ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">customer</span><span class="op">$</span><span class="va">Customer_ID</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="extracting-recency-frequency-and-monetary" class="level3"><h3 class="anchored" data-anchor-id="extracting-recency-frequency-and-monetary">Extracting Recency, Frequency and Monetary</h3>
<section id="recency" class="level4"><h4 class="anchored" data-anchor-id="recency">Recency</h4>
<p>To extract how recent the customer purchase an item from the store, we will use the last <code>InvoiceDate</code> to substract all the dates a customer purchase from the store and retrieve the minimum number. Since the format of <code>Recency</code> will be in datetime format, we will convert it using the <code>as.numeric</code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">customer_recency</span> <span class="op">&lt;-</span> <span class="va">customer</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>recency <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">InvoiceDate</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">-</span> <span class="va">InvoiceDate</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Customer_ID</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span> <span class="op">(</span>Recency <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">recency</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="frequency" class="level4"><h4 class="anchored" data-anchor-id="frequency">Frequency</h4>
<p>To extract how frequent the customer purchase an item from the store, we will use the <code>n()</code> function to find out how many different dates the customer visited the store.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">customer_frequency</span> <span class="op">&lt;-</span> <span class="va">customer</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Customer_ID</span>,<span class="va">InvoiceDate</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span> <span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span> <span class="op">(</span><span class="va">Customer_ID</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span> <span class="op">(</span>Frequency <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">customer_monetary</span> <span class="op">&lt;-</span> <span class="va">customer</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Customer_ID</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span> <span class="op">(</span>Monetary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">TotalPrice</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">customer_RFM</span> <span class="op">&lt;-</span> <span class="va">customer_recency</span> <span class="op">%&gt;%</span>
  <span class="fu">left_join</span> <span class="op">(</span><span class="va">customer_frequency</span>, by <span class="op">=</span> <span class="st">"Customer_ID"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">left_join</span> <span class="op">(</span><span class="va">customer_monetary</span>, by <span class="op">=</span> <span class="st">"Customer_ID"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="examining-the-distribution-of-the-rfm-model" class="level3"><h3 class="anchored" data-anchor-id="examining-the-distribution-of-the-rfm-model">Examining the distribution of the RFM model</h3>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Histogram overlaid with kernel density curve</span>
<span class="va">rdplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">customer_RFM</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Recency</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span>,      <span class="co"># Histogram with density instead of count on y-axis</span>
                   binwidth<span class="op">=</span><span class="fl">10</span>,
                   colour<span class="op">=</span><span class="st">"black"</span>, fill<span class="op">=</span><span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_density</span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">.2</span>, fill<span class="op">=</span><span class="st">"#ff9285"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.title.y<span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, axis.ticks.x<span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        axis.line<span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span><span class="op">)</span>

<span class="va">fdplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">customer_RFM</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Frequency</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span>,      <span class="co"># Histogram with density instead of count on y-axis</span>
                   binwidth<span class="op">=</span><span class="fl">2</span>,
                   colour<span class="op">=</span><span class="st">"black"</span>, fill<span class="op">=</span><span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_density</span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">.2</span>, fill<span class="op">=</span><span class="st">"#906efa"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.title.y<span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, axis.ticks.x<span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        axis.line<span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span><span class="op">)</span>

<span class="va">mdplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">customer_RFM</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Monetary</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span>,      <span class="co"># Histogram with density instead of count on y-axis</span>
                   binwidth<span class="op">=</span><span class="fl">250</span>,
                   colour<span class="op">=</span><span class="st">"black"</span>, fill<span class="op">=</span><span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_density</span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">.2</span>, fill<span class="op">=</span><span class="st">"#d18500"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.title.y<span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, axis.ticks.x<span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        axis.line<span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span><span class="op">)</span>


<span class="va">rdplot</span> <span class="op">+</span> <span class="va">fdplot</span> <span class="op">+</span> <span class="va">mdplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Through the skewness and the histogrm, we can conclude that the attributes does not conform to normal distribution. Since all three attributes does not conform to a normal distribution and K-means would perform better with a normal distributed data, we will conduct data transformation. Utilizing the <code>bestNormalise</code> library, we can identify which normalization techniques best suits each attributes based on their distribution.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">skewness</span><span class="op">(</span><span class="va">customer_RFM</span><span class="op">$</span><span class="va">Recency</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7240294</code></pre>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">skewness</span><span class="op">(</span><span class="va">customer_RFM</span><span class="op">$</span><span class="va">Frequency</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.781094</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">skewness</span><span class="op">(</span><span class="va">customer_RFM</span><span class="op">$</span><span class="va">Monetary</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.435198</code></pre>
</div>
</div>
<p>We can</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">bestNormalize</span><span class="op">(</span><span class="va">customer_RFM</span><span class="op">$</span><span class="va">Recency</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 5010 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 11.2632
 - Box-Cox: 8.2449
 - Center+scale: 28.9884
 - Exp(x): 22.7727
 - Log_b(x+a): 11.2478
 - orderNorm (ORQ): 1.2118
 - sqrt(x + a): 10.1503
 - Yeo-Johnson: 8.4653
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
orderNorm Transformation with 5010 nonmissing obs and ties
 - 552 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
   1   32  121  382  676 </code></pre>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">bestNormalize</span><span class="op">(</span><span class="va">customer_RFM</span><span class="op">$</span><span class="va">Frequency</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 5010 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 82.5693
 - Box-Cox: 83.245
 - Center+scale: 82.2217
 - Exp(x): 74.932
 - Log_b(x+a): 82.5422
 - orderNorm (ORQ): 82.2353
 - sqrt(x + a): 82.6168
 - Yeo-Johnson: 83.4307
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
Standardized exp(x) Transformation with 5010 nonmissing obs.:
 Relevant statistics:
 - mean (before standardization) = 2.741283e+28 
 - sd (before standardization) = 1.940317e+30 </code></pre>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">bestNormalize</span><span class="op">(</span><span class="va">customer_RFM</span><span class="op">$</span><span class="va">Monetary</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 5010 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 2.4477
 - Box-Cox: 1.8361
 - Center+scale: 20.5277
 - Log_b(x+a): 2.4527
 - orderNorm (ORQ): 1.1718
 - sqrt(x + a): 5.5001
 - Yeo-Johnson: 1.8335
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
orderNorm Transformation with 5010 nonmissing obs and ties
 - 2312 unique values 
 - Original quantiles:
     0%     25%     50%     75%    100% 
   4.00  313.25  713.50 1555.00 5004.00 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">customer_RFM_dt</span> <span class="op">&lt;-</span> <span class="va">customer_RFM</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">Recency</span>, <span class="va">Frequency</span>, <span class="va">Monetary</span><span class="op">)</span>

<span class="va">Recency</span> <span class="op">&lt;-</span> <span class="fu">orderNorm</span><span class="op">(</span><span class="va">customer_RFM_dt</span><span class="op">$</span><span class="va">Recency</span><span class="op">)</span>
<span class="va">Frequency</span> <span class="op">&lt;-</span> <span class="fu">boxcox</span> <span class="op">(</span><span class="va">customer_RFM_dt</span><span class="op">$</span><span class="va">Frequency</span><span class="op">)</span>
<span class="va">Monetary</span> <span class="op">&lt;-</span> <span class="fu">orderNorm</span><span class="op">(</span><span class="va">customer_RFM_dt</span><span class="op">$</span><span class="va">Monetary</span><span class="op">)</span>

<span class="va">customer_RFM_dt</span><span class="op">$</span><span class="va">Recency</span> <span class="op">&lt;-</span> <span class="va">Recency</span><span class="op">$</span><span class="va">x.t</span>
<span class="va">customer_RFM_dt</span><span class="op">$</span><span class="va">Frequency</span> <span class="op">&lt;-</span> <span class="va">Frequency</span><span class="op">$</span><span class="va">x.t</span>
<span class="va">customer_RFM_dt</span><span class="op">$</span><span class="va">Monetary</span> <span class="op">&lt;-</span> <span class="va">Monetary</span><span class="op">$</span><span class="va">x.t</span>

<span class="fu">skewness</span><span class="op">(</span><span class="va">customer_RFM_dt</span><span class="op">$</span><span class="va">Recency</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01507482</code></pre>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">skewness</span><span class="op">(</span><span class="va">customer_RFM_dt</span><span class="op">$</span><span class="va">Frequency</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08897177</code></pre>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">skewness</span><span class="op">(</span><span class="va">customer_RFM_dt</span><span class="op">$</span><span class="va">Monetary</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0006851529</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Histogram overlaid with kernel density curve</span>
<span class="va">rdplot_dt</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">customer_RFM_dt</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Recency</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span>,      <span class="co"># Histogram with density instead of count on y-axis</span>
                   colour<span class="op">=</span><span class="st">"black"</span>, fill<span class="op">=</span><span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_density</span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">.2</span>, fill<span class="op">=</span><span class="st">"#ff9285"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.title.y<span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, axis.ticks.x<span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        axis.line<span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span><span class="op">)</span>

<span class="va">fdplot_dt</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">customer_RFM_dt</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Frequency</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span>,      <span class="co"># Histogram with density instead of count on y-axis</span>
                   colour<span class="op">=</span><span class="st">"black"</span>, fill<span class="op">=</span><span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_density</span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">.2</span>, fill<span class="op">=</span><span class="st">"#906efa"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.title.y<span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, axis.ticks.x<span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        axis.line<span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span><span class="op">)</span>

<span class="va">mdplot_dt</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">customer_RFM_dt</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Monetary</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span>,      <span class="co"># Histogram with density instead of count on y-axis</span>
                   colour<span class="op">=</span><span class="st">"black"</span>, fill<span class="op">=</span><span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_density</span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">.2</span>, fill<span class="op">=</span><span class="st">"#d18500"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.title.y<span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, axis.ticks.x<span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        axis.line<span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span><span class="op">)</span>


<span class="va">rdplot_dt</span> <span class="op">+</span> <span class="va">fdplot_dt</span> <span class="op">+</span> <span class="va">mdplot_dt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">customer_RFM_cluster</span> <span class="op">&lt;-</span> <span class="va">customer_RFM_dt</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">Recency</span>, <span class="va">Frequency</span>, <span class="va">Monetary</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="k-means-clustering" class="level3"><h3 class="anchored" data-anchor-id="k-means-clustering">K-means Clustering</h3>
<p>To identify the optimal number of clusters using K means clustering, we will use the <code>fviz_nbclust</code> function and the <code>silhouette</code> and <code>wss</code>. Based on the silhouette score, the optimal cluster is 2 while the WSS score shows either 2 or 3. We will now explore both cluster size.</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>

<span class="fu">fviz_nbclust</span><span class="op">(</span><span class="va">customer_RFM_cluster</span>, <span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"silhouette"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">fviz_nbclust</span><span class="op">(</span><span class="va">customer_RFM_cluster</span>, <span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"wss"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="insights-from-cluster" class="level3"><h3 class="anchored" data-anchor-id="insights-from-cluster">Insights from Cluster</h3>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">km_cluster2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">customer_RFM_cluster</span>, 
                     <span class="fl">2</span>, 
                     nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>



<span class="va">km_cluster3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">customer_RFM_cluster</span>, 
                     <span class="fl">3</span>, 
                     nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>

<span class="va">customer_RFM</span><span class="op">$</span><span class="va">km_cluster2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">km_cluster2</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span>

<span class="va">customer_RFM</span><span class="op">$</span><span class="va">km_cluster3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">km_cluster3</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From the table, we can identify that cluster 1 consist of customers on average made a purchase within 94 days, frequent the store 5 times and spend 1.7k. Whereas for cluster 2, the customers recency period on average is about 325 days, frequent on average 1 time and spend about $392. We can say that cluster 1 consist of our high value customers and cluster 2 consist of potential churn customers.</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">customer_RFM</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">km_cluster2</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>mean_recency <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Recency</span><span class="op">)</span>,
            mean_frequency <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Frequency</span><span class="op">)</span>,
            mean_monetary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Monetary</span><span class="op">)</span>,
            members <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  km_cluster2 mean_recency mean_frequency mean_monetary members
  &lt;chr&gt;              &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;   &lt;int&gt;
1 1                   94.1           5.45         1774.    2595
2 2                  326.            1.39          393.    2415</code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">customer_RFM</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">km_cluster3</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>mean_recency <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Recency</span><span class="op">)</span>,
            mean_frequency <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Frequency</span><span class="op">)</span>,
            mean_monetary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Monetary</span><span class="op">)</span>,
            members <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  km_cluster3 mean_recency mean_frequency mean_monetary members
  &lt;chr&gt;              &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;   &lt;int&gt;
1 1                  364.            1.11          295.    1681
2 2                   54.6           7.32         2431.    1391
3 3                  177.            2.80          865.    1938</code></pre>
</div>
</div>
<p>To better visualise the distribution of our customers based on their cluster, we will leverage on the <code>ggparcoord</code> to visualise the distribution using a parallel coordinates plot.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Plot</span>
<span class="fu">ggparcoord</span><span class="op">(</span><span class="va">customer_RFM</span>,
    columns <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, groupColumn <span class="op">=</span> <span class="fl">5</span>,
    showPoints <span class="op">=</span> <span class="cn">TRUE</span>,
    scale<span class="op">=</span><span class="st">"uniminmax"</span>,
    title <span class="op">=</span> <span class="st">"Parallel Coordinate Plot for the Customer Data"</span>,
    alphaLines <span class="op">=</span> <span class="fl">0.3</span>
    <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
  <span class="op">)</span>  <span class="op">+</span> <span class="fu">scale_color_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">guides</span><span class="op">(</span>color<span class="op">=</span><span class="fu">guide_legend</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Cluster"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><script src="https://giscus.app/client.js" data-repo="jordanong09/ISSS624_Geospatial" data-repo-id="R_kgDOIciwvg" data-category="General" data-category-id="DIC_kwDOIciwvs4CSm3Z" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>