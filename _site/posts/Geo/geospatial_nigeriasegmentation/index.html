<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Ong Zhi Rong Jordan">
<meta name="dcterms.date" content="2022-12-07">
<title>Bringing Data to Life - Regionalisation of Multivariate Water Point Attributes with Non-spatially Constrained and Spatially Constrained Clustering Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="../../../site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="../../../site_libs/jquery-1.12.4/jquery.min.js"></script><link href="../../../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="../../../site_libs/leaflet-1.3.1/leaflet.js"></script><link href="../../../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="../../../site_libs/proj4-2.6.2/proj4.min.js"></script><script src="../../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="../../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="../../../site_libs/leaflet-binding-2.1.1/leaflet.js"></script><script src="../../../site_libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="../../../site_libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../../../styles.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../media/profile.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Bringing Data to Life</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html">About Me</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jordanong09"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a>
  <ul class="collapse">
<li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries">Libraries</a></li>
  </ul>
</li>
  <li>
<a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a>
  <ul class="collapse">
<li><a href="#importing-of-data" id="toc-importing-of-data" class="nav-link" data-scroll-target="#importing-of-data">Importing of data</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">Data Wrangling</a></li>
  <li><a href="#data-normalization" id="toc-data-normalization" class="nav-link" data-scroll-target="#data-normalization">Data Normalization</a></li>
  </ul>
</li>
  <li>
<a href="#conventional-clustering" id="toc-conventional-clustering" class="nav-link" data-scroll-target="#conventional-clustering">Conventional Clustering</a>
  <ul class="collapse">
<li><a href="#hierarchical-clustering" id="toc-hierarchical-clustering" class="nav-link" data-scroll-target="#hierarchical-clustering">Hierarchical Clustering</a></li>
  <li><a href="#k-means-clustering" id="toc-k-means-clustering" class="nav-link" data-scroll-target="#k-means-clustering">K-Means Clustering</a></li>
  <li><a href="#partitioning-around-medodoids-pam-clustering" id="toc-partitioning-around-medodoids-pam-clustering" class="nav-link" data-scroll-target="#partitioning-around-medodoids-pam-clustering">Partitioning Around Medodoids (PAM) Clustering</a></li>
  <li><a href="#visualisation-of-traditional-clustering-results" id="toc-visualisation-of-traditional-clustering-results" class="nav-link" data-scroll-target="#visualisation-of-traditional-clustering-results">Visualisation of Traditional Clustering Results</a></li>
  </ul>
</li>
  <li>
<a href="#spatially-constrainted-clustering" id="toc-spatially-constrainted-clustering" class="nav-link" data-scroll-target="#spatially-constrainted-clustering">Spatially Constrainted Clustering</a>
  <ul class="collapse">
<li><a href="#skater" id="toc-skater" class="nav-link" data-scroll-target="#skater">SKATER</a></li>
  <li><a href="#spatially-constrained-hierarchical-clustering" id="toc-spatially-constrained-hierarchical-clustering" class="nav-link" data-scroll-target="#spatially-constrained-hierarchical-clustering">Spatially Constrained Hierarchical Clustering</a></li>
  <li><a href="#redcap" id="toc-redcap" class="nav-link" data-scroll-target="#redcap">REDCAP</a></li>
  <li><a href="#visualisation-of-spatially-constrained-clustering-results" id="toc-visualisation-of-spatially-constrained-clustering-results" class="nav-link" data-scroll-target="#visualisation-of-spatially-constrained-clustering-results">Visualisation of Spatially Constrained Clustering Results</a></li>
  </ul>
</li>
  <li>
<a href="#interpretation-of-all-the-clustering-results-using-statistical-graph" id="toc-interpretation-of-all-the-clustering-results-using-statistical-graph" class="nav-link" data-scroll-target="#interpretation-of-all-the-clustering-results-using-statistical-graph">Interpretation of all the Clustering Results using Statistical graph</a>
  <ul class="collapse">
<li><a href="#visualisation-of-all-the-clustering-results" id="toc-visualisation-of-all-the-clustering-results" class="nav-link" data-scroll-target="#visualisation-of-all-the-clustering-results">Visualisation of all the Clustering Results</a></li>
  <li><a href="#visualisation-of-all-the-clustering-results-using-statistical-plot" id="toc-visualisation-of-all-the-clustering-results-using-statistical-plot" class="nav-link" data-scroll-target="#visualisation-of-all-the-clustering-results-using-statistical-plot">Visualisation of all the Clustering Results using statistical plot</a></li>
  </ul>
</li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Regionalisation of Multivariate Water Point Attributes with Non-spatially Constrained and Spatially Constrained Clustering Methods</h1>
<p class="subtitle lead">Understanding the difference between traditional clustering algorithm and spatially constrained clustering algorithm.</p>
  <div class="quarto-categories">
    <div class="quarto-category">geospatial</div>
    <div class="quarto-category">sf</div>
    <div class="quarto-category">spdep</div>
    <div class="quarto-category">tmap</div>
    <div class="quarto-category">clustering</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ong Zhi Rong Jordan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 7, 2022</p>
    </div>
  </div>
    
  </div>
  

</header><section id="overview" class="level2"><h2 class="anchored" data-anchor-id="overview">Overview</h2>
<section id="introduction" class="level3"><h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>A regionalization is a specific type of clustering whose goal is to combine data that are comparable in both their statistical characteristics and their geographic locations. Regionalization uses the same logic as conventional clustering approaches in this regard, but it additionally imposes a number of geographical restrictions. These restrictions frequently have to do with connectivity. It is not always necessary for connectedness to be true for all regions, and in some situations it makes sense to loosen connectivity or to impose alternative kinds of geographic restrictions.</p>
<p>For this post, we will examine <strong>Traditional Clustering Algorithm</strong> and <strong>Spatially Constrained Clustering Algorithm</strong> to identify its utility and limitations.</p>
</section><section id="libraries" class="level3"><h3 class="anchored" data-anchor-id="libraries">Libraries</h3>
<p>For this study, we will use the following packages from CRAN.</p>
<p>For <strong>Geographical Analysis</strong> and Visualisation the packages used are:&nbsp;</p>
<ul>
<li><p><a href="https://cloud.r-project.org/web/packages/sf/index.html"><code>sf</code></a> - Support for simple features, a standardized way to encode spatial vector data. Binds to ‘GDAL’ for reading and writing data, to ‘GEOS’ for geometrical operations, and to ‘PROJ’ for projection conversions and datum transformations. Uses by default the ‘s2’ package for spherical geometry operations on ellipsoidal (long/lat) coordinates.</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/tmap/index.html"><code>tmap</code></a> - Thematic maps are geographical maps in which spatial data distributions are visualized. This package offers a flexible, layer-based, and easy to use approach to create thematic maps, such as choropleths and bubble maps.</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/spdep/index.html"><code>spdep</code></a> - A collection of functions to create spatial weights matrix objects from polygon ‘contiguities’, from point patterns by distance and tessellations, for summarizing these objects, and for permitting their use in spatial data analysis, including regional aggregation by minimum spanning tree; a collection of tests for spatial ‘autocorrelation’.</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/ClustGeo/vignettes/intro_ClustGeo.html"><code>ClustGeo</code></a> - Ward-like hierarchical clustering algorithm including spatial/geographical constraints.</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/rgdal/index.html"><code>rgdal</code></a> - Provides bindings to the ‘Geospatial’ Data Abstraction Library (‘GDAL’) and access to projection/transformation operations from the ‘PROJ’ library.</p></li>
<li><p><a href="https://geodacenter.github.io/rgeoda/"><code>rgeoda</code></a> - For spatial data analysis based on libgeoda and GeoDa.</p></li>
</ul>
<p>For <strong>Traditional Clustering Algorithm</strong> the packages used are:&nbsp;</p>
<ul>
<li><p><a href="https://cran.r-project.org/web/packages/rgdal/index.html"><code>cluster</code></a> - Provides bindings to the ‘Geospatial’ Data Abstraction Library (‘GDAL’) and access to projection/transformation operations from the ‘PROJ’ library.</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/factoextra/index.html"><code>factoextra</code></a> - Extract and visualize the output of multivariate data analyses.</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/NbClust/NbClust.pdf"><code>NbClust</code></a> - Determining the Best Number of Clusters in a Data Set.</p></li>
</ul>
<p>For <strong>Data Wrangling and Simple Visualisation</strong> the packages used are:&nbsp;</p>
<ul>
<li><p><a href="https://patchwork.data-imaginist.com/"><code>patchwork</code></a> - Combine separate ggplots into the same graphic.</p></li>
<li><p><a href="https://www.tidyverse.org/packages/"><code>tidyverse</code></a> - Loading the core tidyverse packages which will be used for data wrangling and visualisation.</p></li>
<li><p><a href="https://www.rdocumentation.org/packages/heatmaply/versions/1.4.0/topics/heatmaply"><code>heatmaply</code></a> - Cluster heatmap based on plotly.</p></li>
<li><p><a href="https://www.rdocumentation.org/packages/corrplot/versions/0.92/topics/corrplot"><code>corrplot</code></a> - A graphical display of a correlation matrix, confidence interval.</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/psych/index.html"><code>psych</code></a> - A general purpose toolbox for personality, psychometric theory and experimental psychology.</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/reshape2/index.html"><code>reshape2</code></a> - Flexibly restructure and aggregate data using just two functions: melt and ‘dcast’.</p></li>
<li><p><a href="https://patchwork.data-imaginist.com/"><code>hrbrthemes</code></a> - Provides typography-centric themes and theme components for ggplot2.</p></li>
<li><p><a href="https://patchwork.data-imaginist.com/"><code>ggstatsplot</code></a> - An extension of {ggplot2} package for creating graphics with details from statistical tests included in the information-rich plots themselves</p></li>
</ul>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">rgdal</span>, <span class="va">spdep</span>, <span class="va">tmap</span>, <span class="va">sf</span>, <span class="va">ClustGeo</span>,<span class="va">rgeoda</span>, 
               <span class="va">cluster</span>, <span class="va">factoextra</span>, <span class="va">NbClust</span>,
               <span class="va">heatmaply</span>, <span class="va">corrplot</span>, <span class="va">psych</span>, <span class="va">tidyverse</span>,<span class="va">reshape2</span>,<span class="va">hrbrthemes</span>, <span class="va">GGally</span>, <span class="va">ggstatsplot</span>, <span class="va">patchwork</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="data-preparation" class="level2"><h2 class="anchored" data-anchor-id="data-preparation">Data Preparation</h2>
<p>Two dataset will be used for this study:</p>
<ul>
<li>Nigeria.shp: A shapefile of Nigeria from <a href="https://data.humdata.org/dataset/geoboundaries-admin-boundaries-for-nigeria"><code>Humanitarian Data Exchange Portal</code></a> that consist of all the Level-2 Administrative Boundary (also known as Local Government Area)</li>
<li>NigeriaAttribute.csv: A csv file containing multiple water point attributes of each Level-2 Administrative Nigeria Boundary from the <a href="https://www.waterpointdata.org/access-data/"><code>WPdx Global Data Repositories</code></a>
</li>
</ul>
<section id="importing-of-data" class="level3"><h3 class="anchored" data-anchor-id="importing-of-data">Importing of data</h3>
<p>We will use the <em>st_read</em> to import the shape file and <em>read_csv</em> to import the aspatial data into the R environment.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span>dsn <span class="op">=</span> <span class="st">"data"</span>, 
                 layer <span class="op">=</span> <span class="st">"geoBoundaries-NGA-ADM2"</span><span class="op">)</span>

<span class="va">nigeria_attribute</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/nigeriaattribute.csv"</span><span class="op">)</span>

<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">shapeName</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">st_transform</span><span class="op">(</span>crs <span class="op">=</span> <span class="fl">26391</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
</section><section id="data-wrangling" class="level3"><h3 class="anchored" data-anchor-id="data-wrangling">Data Wrangling</h3>
<p>The practice of correcting or deleting inaccurate, damaged, improperly formatted, duplicate, or incomplete data from a dataset is known as <strong>data wrangling</strong>. There are numerous ways for data to be duplicated or incorrectly categorized when merging multiple data sources. We willl now proceed to ensure our data is cleaned before conducting our analysis.</p>
<section id="checking-of-duplicated-area-name" class="level4"><h4 class="anchored" data-anchor-id="checking-of-duplicated-area-name">Checking of duplicated area name</h4>
<p>Firstly, we will order our dataframe by alphabetical order based on the shapeName. We will then use the <code>duplicated</code> function to retrieve all the shapeName that has duplicates and store it in a list. From the result below, we identified <strong>12</strong> shapeNames that are duplicates.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">nigeria</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">$</span><span class="va">shapeName</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span>

<span class="va">nigeria</span><span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>shapeName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="va">shapeName</span><span class="op">)</span><span class="op">)</span>

<span class="va">duplicate_area</span> <span class="op">&lt;-</span> <span class="va">nigeria</span><span class="op">$</span><span class="va">shapeName</span><span class="op">[</span> <span class="va">nigeria</span><span class="op">$</span><span class="va">shapeName</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">nigeria</span><span class="op">$</span><span class="va">shapeName</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">$</span><span class="va">shapeName</span><span class="op">)</span><span class="op">]</span> <span class="op">]</span>

<span class="va">duplicate_area</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "bassa"    "bassa"    "ifelodun" "ifelodun" "irepodun" "irepodun"
 [7] "nasarawa" "nasarawa" "obi"      "obi"      "surulere" "surulere"</code></pre>
</div>
</div>
<p>Next, we will leverage on the interactive viewer of <code>tmap</code> to check the location of each area. Through the use of Google, we are able to retrieve the actual name and state of the areas. The table below shows the index and the actual name of the area.</p>
<table class="table">
<thead><tr class="header">
<th>Index</th>
<th>Actual Area Name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>94</td>
<td>Bassa (Kogi)</td>
</tr>
<tr class="even">
<td>95</td>
<td>Bassa (Plateau)</td>
</tr>
<tr class="odd">
<td>304</td>
<td>Ifelodun (Kwara)</td>
</tr>
<tr class="even">
<td>305</td>
<td>Ifelodun (Osun)</td>
</tr>
<tr class="odd">
<td>355</td>
<td>Irepodun (Kwara)</td>
</tr>
<tr class="even">
<td>356</td>
<td>Irepodun (Osun)</td>
</tr>
<tr class="odd">
<td>518</td>
<td>Nassarawa</td>
</tr>
<tr class="even">
<td>546</td>
<td>Obi (Benue)</td>
</tr>
<tr class="odd">
<td>547</td>
<td>Obi(Nasarawa)</td>
</tr>
<tr class="even">
<td>693</td>
<td>Surulere (lagos)</td>
</tr>
<tr class="odd">
<td>694</td>
<td>Surulere (Oyo)</td>
</tr>
</tbody>
</table>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">tmap_mode</span><span class="op">(</span><span class="st">"view"</span><span class="op">)</span>

<span class="fu">tm_shape</span><span class="op">(</span><span class="va">nigeria</span><span class="op">[</span><span class="va">nigeria</span><span class="op">$</span><span class="va">shapeName</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">duplicate_area</span>,<span class="op">]</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_polygons</span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<div id="htmlwidget-6542cf465640d0a9e358" style="width:100%;height:464px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-6542cf465640d0a9e358">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["Esri.WorldGrayCanvas",null,"Esri.WorldGrayCanvas",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,"Esri.WorldTopoMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addPolygons","args":[[[[{"lng":[6.70854125740683,6.70903050240698,6.71309285540835,6.71033476241135,6.69930404941713,6.69930423741859,6.70941582941894,6.7204466274184,6.73515457041642,6.74434717541629,6.74894331641695,6.75262011741786,6.75528286341935,6.75596374441968,6.75813576442071,6.76824772442223,6.76943789542252,6.78801146441948,6.79904222241815,6.82570041241326,6.84960081540959,6.8836129994029,6.91670606239639,6.96358783938761,6.96628717338768,6.97803095438645,6.98784250938503,6.99173052938508,6.99465475238494,7.0044941653831,7.01533531738079,7.05293445137309,7.0728455113697,7.11785511436146,7.19590318034774,7.25384082433728,7.30555392932725,7.3931783603101,7.40448517630782,7.43244234430216,7.4457867432993,7.43052683830067,7.42478081430118,7.41807742830197,7.40945886330235,7.39653010130382,7.38982666530405,7.38503832730402,7.37785616230438,7.37115276830506,7.35870315530658,7.35056312530711,7.34625378930584,7.34721145030438,7.34912673830288,7.3467325223029,7.33476206330459,7.32231275230646,7.31465160930777,7.2974137323107,7.28783738531213,7.27490889631464,7.26102314031731,7.24905260331945,7.23516653632205,7.21745006832554,7.20643716532755,7.19733958532914,7.18058056233163,7.17675024533194,7.16046991733343,7.14802085733467,7.13652894833628,7.12695263433795,7.11498203233967,7.1044479683416,7.09036170434444,7.07809990134724,7.06990143834925,7.06694555634996,7.04577881135425,7.01125023836134,6.99898106836388,6.9940491323649,6.98815332436615,6.98070944136743,6.97808079136766,6.97249323036776,6.96808569636791,6.9649882923681,6.96103799536849,6.94930883936958,6.93877465837094,6.91818539337487,6.90908753237652,6.87652790238313,6.85354425238705,6.84109455738903,6.83199694239008,6.82529342339064,6.82146322539044,6.82050509538984,6.81906896738964,6.82050522638902,6.82002628238853,6.81619601438837,6.81619585438727,6.81284423738709,6.81332314638543,6.81428051538299,6.81571721538168,6.81319895638109,6.80757712338155,6.79464864038406,6.78507228638626,6.77453794038932,6.76927080439111,6.76544033939283,6.75873706139517,6.75442735439637,6.73910512439979,6.73636347440043,6.73073759540169,6.72702630140264,6.72008591340421,6.70854125740683],"lat":[7.48585728768861,7.48872477568943,7.5125150296958,7.5382542947022,7.57410477771052,7.58973211971458,7.61730956672255,7.63753256672867,7.65040196573321,7.67062558573923,7.68901066574435,7.70739541774942,7.73032724175564,7.73560414575711,7.75243846076166,7.79380452577331,7.80043600877518,7.81127062077946,7.82322082078345,7.83333267378816,7.84987889079431,7.8572329207988,7.86458676980326,7.8792948788106,7.88680885481281,7.90160666481751,7.90951809682033,7.91936163682321,7.92527078882499,7.92827093582648,7.92832962782733,7.93227977283111,7.94274468283531,7.95902501284288,7.9930214058574,8.01504695286729,8.02558128287371,8.04186144788416,8.0429649138852,8.04569236488789,8.04486092288863,8.02270902988187,8.01456840887938,8.00738625587709,7.98966965887195,7.97482638886719,7.9609404648632,7.94896982085977,7.93556274785584,7.92694373085315,7.91401528384897,7.9001297858448,7.87475191283808,7.85990855783441,7.84698020083126,7.84171285982978,7.83213663382642,7.82351771782332,7.82016617582187,7.81154728381842,7.804843551816,7.80292833381451,7.79957663081258,7.79478849681048,7.79143666480855,7.78856362580646,7.78473267480464,7.780902328803,7.76845318079852,7.76270712579679,7.74115989179004,7.72535889578507,7.71578221478175,7.71195161778004,7.7028541397768,7.69902370177498,7.69734688777349,7.69948414977303,7.70220157577308,7.7035061927732,7.70051370277077,7.6979279867674,7.69666129276607,7.69615430476557,7.69588187876505,7.69260053276363,7.6891056817625,7.67671276675892,7.66852725475647,7.66286916175476,7.6580051567532,7.64252229974832,7.63294608774502,7.62720004174195,7.62432719574048,7.62001740873674,7.60900455273203,7.60134371472907,7.59128795172579,7.5821905127229,7.57117747771975,7.56207979471735,7.55681289471591,7.55346107371515,7.54723657271356,7.53670214871055,7.52521025070759,7.5151553147048,7.49887524370067,7.47541274769483,7.46487850669228,7.45298474268908,7.44476789368653,7.4418949626847,7.44381051268441,7.45195045668557,7.4586539066868,7.4682301636889,7.47732827469066,7.48020113169102,7.48115882569001,7.48194190168998,7.48220245168958,7.48402554768969,7.48444396268923,7.48585728768861]}]],[[{"lng":[8.82352165515587,8.82634280715525,8.82842536315472,8.85036496115004,8.85853570714825,8.87019270814563,8.88710984214226,8.89288133214109,8.89869336113996,8.90391833413888,8.90737629813816,8.91228602413715,8.91814350813591,8.92583471113443,8.92977062213357,8.93571565413226,8.93790529413159,8.94219674213039,8.94630987012939,8.94867786612854,8.9527912831275,8.95489228912697,8.95359205112671,8.9538604851264,8.94469153212786,8.93918994812871,8.9356118881292,8.93579006812899,8.93605704212871,8.93641395912837,8.93466831212856,8.93124659512916,8.93144805612902,8.92970209312881,8.92988031512867,8.93014735412838,8.93032671112817,8.93828475312636,8.94221901812551,8.94615438712469,8.95106682212359,8.96005888712154,8.96591645812035,8.96792861711988,8.97387581711854,8.97606561911791,8.97816680011734,8.97668957711719,8.97713468011671,8.97355766611721,8.97181151211741,8.9719898311172,8.97216812511703,8.97435767411634,8.97270186811639,8.97288016711622,8.97122500811632,8.96983622911609,8.96809203111628,8.96827036711606,8.9667034301161,8.96312495811654,8.96540521811573,8.96357088311605,8.96209332111595,8.9606158591158,8.96097262111542,8.9594060601154,8.95783898711533,8.95639688411549,8.95041477111659,8.94858191611682,8.94089016511835,8.93713360711899,8.93328833911972,8.92944248012051,8.92367344112162,8.91790555212278,8.9122259571238,8.90645697412494,8.90261175712571,8.90175809912581,8.89923660712634,8.88429711812903,8.86852680613205,8.85110320913472,8.84363764713578,8.82953611013779,8.8293034691377,8.82461447313844,8.819551943139,8.819340795139,8.81390747813961,8.8060263241407,8.80368828014105,8.79956543814151,8.79992205814113,8.80146083014075,8.80192307414043,8.80316065413963,8.80131987713956,8.78225106214289,8.77365019914367,8.77243449514283,8.76630047514271,8.76200735114259,8.75278742014394,8.74836775714456,8.73926475214604,8.72019713814977,8.70482291115267,8.69559748215449,8.69437323915439,8.6983675291531,8.69728762015331,8.69248075515423,8.68597741115551,8.66670458515945,8.65317188316224,8.64210293516433,8.6285713801671,8.62389952716815,8.61896826716929,8.61546522217011,8.62035577316959,8.62411223716893,8.62779037616837,8.6316211631677,8.63715017116694,8.63714225116729,8.63220766416895,8.63158342916951,8.63157105617009,8.62988594717094,8.630520125171,8.63025202617134,8.62806235917202,8.62953858117218,8.6290943391727,8.62882733517306,8.62654769717387,8.62033346417558,8.61814335417626,8.61962120417643,8.62319950717597,8.62677792717552,8.62852314917536,8.63585767217425,8.63550099917467,8.63322165917545,8.62910932117656,8.62289510217821,8.61685969417968,8.61082354418114,8.61055673318144,8.61422262018089,8.61771285918057,8.62461878717924,8.62723854617871,8.63483972817731,8.64069815617606,8.65223492017374,8.66176034117197,8.66734990017101,8.67302969116995,8.67660810716953,8.67991918516935,8.67947381616988,8.67527227217104,8.67482675017155,8.67263599417223,8.66843404317343,8.66222071017507,8.66020891017556,8.65390607017727,8.64979250917834,8.64943595517873,8.64514443818004,8.64112082618098,8.63517473618232,8.63106168318341,8.62869359018426,8.62833712018467,8.62815859818487,8.62954731218504,8.63303664118472,8.63844880718394,8.64395040718308,8.64569476318291,8.6472607881829,8.64672689418348,8.64829246318346,8.64601342918426,8.64950258818384,8.65491600918309,8.66233896418182,8.66976331118061,8.67352037717994,8.68085493917876,8.68461103317807,8.68827935117749,8.69579237617619,8.69753656517596,8.70303832917512,8.70862857517415,8.71046238117384,8.71806434817243,8.72557762317111,8.72924498517051,8.73105731917016,8.7364281941692,8.75059224016649,8.76783618416329,8.78261594716057,8.78999926415963,8.79738034515893,8.79737250715947,8.79613342316018,8.7899688911616,8.78010459916403,8.77648336416494,8.77626233716521,8.77416018916576,8.77197057216641,8.77179231216655,8.77336414116629,8.77756138716545,8.78149614916457,8.78725715716336,8.78936499016287,8.79338922016195,8.7992465871607,8.80501554115957,8.80894947215873,8.81078333815841,8.81647008215737,8.82039844815653,8.82352165515587],"lat":[10.3832819165747,10.3827046435746,10.3793803145738,10.3705598495719,10.3658477475708,10.3576345385689,10.3579197805693,10.3580667125695,10.3582141405697,10.3569515185695,10.3561155565694,10.3551799065692,10.3535098375689,10.3538504955692,10.3520899965688,10.348500202568,10.3428003785665,10.3333399145641,10.3277301685627,10.3181800355602,10.3125803955588,10.3088100815579,10.2952402525542,10.2894603985527,10.2794001195498,10.2733599955481,10.2674105405464,10.2635603115454,10.2577798845438,10.2500698305418,10.2461299985407,10.2451117055403,10.2421407105396,10.2285401455359,10.2246904845349,10.2189100475334,10.2150496455324,10.2096101635311,10.2078602745307,10.2061007325304,10.2031156745297,10.1970701155284,10.1954004035281,10.1935596455276,10.1899595945268,10.1842696545254,10.1804997525244,10.1707801705218,10.1611499815193,10.1551997225177,10.1512605995166,10.1474001615155,10.1435498865145,10.1378604965131,10.1319905955115,10.1281403175105,10.1222698335089,10.1106301305058,10.1066904235047,10.1028401415037,10.0950501415016,10.0890997394999,10.081480177498,10.0794599284974,10.0697498374948,10.0600301244922,10.0523193804902,10.0445298824881,10.036740372486,10.0337572664852,10.0306198734841,10.0285995264835,10.0282604804833,10.0261696994826,10.0260000874824,10.0258196764823,10.025569899482,10.0253093134818,10.023130266481,10.0228700554808,10.0227001054807,10.0221337024805,10.0221330234804,10.0163723854784,10.0130773444771,9.99497865447178,9.98510678746892,9.9670078834637,9.96453903046306,9.9593942044615,9.9499891554589,9.94913298645863,9.93835116145563,9.92810649045265,9.92540031445186,9.91774093344971,9.91003537044768,9.90816356744726,9.90428579044623,9.89208955844303,9.88233106444042,9.87256278843716,9.8518231434314,9.82864851242526,9.79998170841749,9.77985409941198,9.77009102640909,9.76389546940729,9.75666476840509,9.75604110140425,9.75237032840273,9.75114286940208,9.74443391640027,9.73371163239758,9.73366329239756,9.73344968239731,9.73316109939702,9.73404212039657,9.73585935939656,9.73340938839549,9.73400575239521,9.7360850033956,9.73983878939637,9.74239661439698,9.75148288839954,9.75358029640022,9.75761578240146,9.75901251840196,9.76633618240406,9.77426408240619,9.78767615740962,9.79621313241184,9.80841008641509,9.81919608141795,9.82336239041906,9.82914275042061,9.83483698542203,9.84455475542468,9.85418810242727,9.85996732142879,9.86758831843076,9.87696431943309,9.88265903543453,9.8923768374372,9.89832665843892,9.90427759044058,9.90821669944168,9.91626371344408,9.92397026544613,9.93159125844815,9.93719936144951,9.94657592245184,9.95209998545314,9.9576227994544,9.96340254445599,9.96742623245714,9.97530342045938,9.9770096274601,9.97765757746032,9.97992539946117,9.97825404246089,9.97876628146137,9.9811201214623,9.98522866946355,9.98741261346433,9.99336245646604,10.0050897634693,10.0147304274719,10.0222595704738,10.0318900354763,10.0375901134778,10.0451202984797,10.0544997204821,10.0563399794825,10.0676403744854,10.0732497724867,10.0809602104888,10.0904197064912,10.0940999834921,10.0977003724929,10.1033095544943,10.1128594684968,10.1205596844989,10.1244199655,10.1360598185031,10.1439401675053,10.1519003515077,10.1579399035094,10.1618698345106,10.1696702185127,10.1812199645158,10.189020334518,10.19664017452,10.2045095975222,10.2124796775245,10.2186003925263,10.2247198285282,10.2268200765289,10.2348603885312,10.2369605035319,10.2409800015331,10.2451800785344,10.2491199075355,10.2551500815373,10.2592601745386,10.2612799805391,10.2635404015399,10.2677404225412,10.2717600795424,10.2729638215428,10.2750227855435,10.279301553545,10.2848011035469,10.291517786549,10.305548279553,10.3256766245586,10.3397022455624,10.3525083785658,10.3579932355671,10.36957380357,10.3752407535715,10.3800299575728,10.3837902055738,10.3894901765752,10.3933402965763,10.3950702895768,10.3936003395765,10.3918397355761,10.3892710005755,10.3883302705753,10.3846501315744,10.3829802425741,10.3832302675743,10.3814801095739,10.3834897925745,10.3859664125753,10.3839194935748,10.3832819165747]}]],[[{"lng":[4.66410689094862,4.64937108695349,4.64686623995422,4.63823154095678,4.60101310696828,4.59364079797064,4.58574386897275,4.58871011997228,4.58987368597216,4.59095989997207,4.59521467997119,4.60120468196978,4.65015533795723,4.66559663995339,4.68236784194896,4.68584389394779,4.69192444994579,4.696725091944,4.70104218294275,4.70810547194071,4.72533752693655,4.73245139293482,4.74515491593213,4.75328491693057,4.75480944393082,4.75579661193155,4.75620064293144,4.75825974893185,4.75846088393236,4.76159432093266,4.76260506293301,4.76333222593345,4.76270166193421,4.76158937593456,4.76019672393504,4.75525330393626,4.74810770593812,4.73849183294052,4.71980806694526,4.71312449994693,4.69866037595075,4.6920546929525,4.67935138995664,4.67681457295758,4.68352562495693,4.69264646995564,4.70342584695365,4.7233266819498,4.76976105694008,4.78219896993711,4.80624528893189,4.81951229392892,4.83775418892474,4.85516738692085,4.86511758891916,4.87755540591727,4.91901500490917,4.9496951359031,4.98120397089686,4.98369168789777,4.97291237490117,4.94389052590882,4.93228198991231,4.91735642891635,4.88916400992388,4.88253069492662,4.88077638392724,4.87009281193112,4.86262994693423,4.84770495693892,4.83526706394291,4.82614571694631,4.81536625994998,4.81287869595165,4.80873295495393,4.80624528095562,4.80707458995674,4.80458695595834,4.80209928696053,4.80458682696069,4.81287860895953,4.82780403195668,4.8302916899565,4.83941264995446,4.85102129395208,4.85185056795251,4.85185045995296,4.85848423795154,4.86594674894985,4.87258054894848,4.87755536394732,4.87838463494772,4.87838462394801,4.88004304094821,4.87755543594914,4.88128711194867,4.88460348094811,4.89040806094669,4.89621205094438,4.90284586694178,4.90782073494007,4.90782070593897,4.9078206519383,4.902845879939,4.89704138193961,4.89704124393902,4.89538283993746,4.89455365193551,4.89455371893513,4.9053335679312,4.92523388792542,4.95010947991877,4.96005956991615,4.96835192591386,4.9849352289096,4.99322749690717,4.99737317790567,5.01146938090241,5.02971167589787,5.05127050889212,5.05707451489005,5.07863388688213,5.08112158388075,5.09024244887722,5.09853420087466,5.10931348387192,5.1209222038685,5.13999354386347,5.15657763885896,5.16238151985713,5.19306189084961,5.20881594384516,5.23700852483721,5.257738000832,5.27432197182818,5.29007673882553,5.30500216582321,5.31826913882102,5.32656095981965,5.33899884881707,5.35558265481355,5.37216628980985,5.38045848080793,5.4028464248019,5.40865053280026,5.41362584879809,5.42067372479444,5.42316157379249,5.42399069979024,5.42067387078941,5.41901536178812,5.42067386578614,5.42067390578497,5.42564919778253,5.43559941377836,5.4405740647767,5.44637877177489,5.43311160777691,5.41238203678065,5.39662739878315,5.38087280878546,5.37258104778645,5.35931403378839,5.34770532279008,5.34190083779083,5.33078950079185,5.32747327679209,5.32282960379275,5.32150272279284,5.32349305079204,5.32450471979151,5.32102736379165,5.31146290279251,5.30624614579311,5.29972505679415,5.29016119679549,5.28581373079602,5.28103154579673,5.27451092879801,5.26320737680041,5.25581689880192,5.24581803080354,5.23989578380473,5.23408028380607,5.22060390680875,5.20930061981134,5.19799768681402,5.18669474081647,5.17582614481943,5.17626103082033,5.17669585082145,5.17799984282223,5.17539170582339,5.16800128682633,5.15669763983077,5.15235031583258,5.14235150783596,5.13452683483822,5.12191904384124,5.10192149684588,5.08714046384929,5.06583884685389,5.04844953585745,5.03540694586027,5.02497375786263,5.01454024586502,4.99758528086885,4.98541302187173,4.9775877458738,4.96454570987722,4.95541626587955,4.94150497888285,4.93020206788583,4.92063761688852,4.90716074989204,4.890641229896,4.8850302198973,4.86890465790099,4.85673194790378,4.83716870590802,4.82021432891173,4.80630259191407,4.80456408291405,4.80369419691364,4.8032598889123,4.80630251291035,4.80891140490774,4.80412910290768,4.79804281290785,4.78934807790871,4.77587130891102,4.76717656591247,4.75543884691482,4.74741889291667,4.74610473291721,4.7444152919179,4.73754882692076,4.73411561692222,4.72896626092405,4.71952539492715,4.71394637292947,4.7075095259322,4.70278880593433,4.69120214293878,4.67832846694353,4.67232035594564,4.66410689094862],"lat":[8.35635386778848,8.37312232579297,8.37483308979336,8.3806980017947,8.41307418980288,8.42065791880493,8.42369224280541,8.42628143980647,8.42824515680717,8.43036024180794,8.43218461780882,8.43268236580935,8.42218235380908,8.42023362280941,8.41446360680863,8.41024200680748,8.40306774880551,8.39545199580336,8.39251875180267,8.38833515680179,8.38735001480255,8.38684170780289,8.39141473680517,8.39548022380701,8.40361021280974,8.41496551881353,8.41527112581362,8.42675151581752,8.43302781281957,8.44643018082408,8.45380681882659,8.46199849182929,8.46908352383153,8.47043441783194,8.47232800983245,8.47308938483236,8.47464358883241,8.47644173683243,8.48004396883242,8.48152684883246,8.48592848283301,8.48846899583342,8.50218881383715,8.5068178228385,8.51869115984281,8.53030009584721,8.5377627468503,8.54937163685533,8.56595524386364,8.56595523386439,8.57258885786804,8.57507599386968,8.5767344868713,8.58005132287346,8.58834273987677,8.60243887788208,8.62482744789189,8.64058195889885,8.65633669390581,8.67623712091241,8.68784515091555,8.69862541991739,8.70857520591996,8.71603773592154,8.72764688692375,8.74340169792857,8.74644172792944,8.76496028993492,8.78320218294056,8.79895696394493,8.81388195394918,8.8304660299542,8.8462212069588,8.86114582496364,8.87938809096951,8.89514281397461,8.91421415198103,8.92831017998559,8.95152737999327,8.96230675099702,8.97474459200157,8.98469561800568,8.99049938800775,8.99215766100881,8.99796180901133,9.00708270401445,9.01371674201664,9.01620385701781,9.01786205201875,9.02035059501995,9.02117934402047,9.02947168002329,9.03361687702464,9.04273791202779,9.04771317102933,9.05434707803172,9.05766409603301,9.05683422703305,9.04273794802863,9.02781270402393,9.01952102502145,9.00376586101615,8.99381622001284,8.98635383701014,8.97557333200623,8.96645272700317,8.9382603139937,8.9075803519835,8.90177647298153,8.88270454997583,8.86694998297165,8.85617078796944,8.85285360996891,8.84787915396772,8.84290393596702,8.83627026496526,8.82880755396303,8.8296362889641,8.826319861964,8.81719859896221,8.80724890495928,8.76744736194752,8.75666794194414,8.73759670593848,8.72930539593631,8.72598847993585,8.71686758593353,8.70940500193222,8.70028311093024,8.69447896392871,8.68950372192889,8.67872439992639,8.66048252492221,8.65550722192181,8.65633683292308,8.66960321692824,8.68535791193412,8.6977958769388,8.7052584029417,8.7094048079437,8.71355058694598,8.71603779694774,8.7160376969482,8.70442970294583,8.70028318394484,8.68618762094066,8.65882396993247,8.64058202392688,8.61321829091831,8.59165966991135,8.5692719489042,8.54854207589782,8.53361692589315,8.51620377688803,8.49215687988115,8.48552426887942,8.47971905887797,8.46645252187302,8.45235638286733,8.43826004186198,8.42084706285554,8.40923891785143,8.39514251684618,8.38270468284154,8.37524116983885,8.35567282683204,8.34903920282981,8.34439570682803,8.34107863482696,8.33709902682585,8.33378016982488,8.32508577482193,8.30856620081621,8.30074034181341,8.29552357081136,8.28422077680727,8.27856930680519,8.27378735480342,8.27074422880201,8.26813505380047,8.26552666779914,8.25726693879587,8.25506794879484,8.25465865179428,8.24944207879176,8.24857245279073,8.24944199679024,8.24726874278879,8.25205037878955,8.26422302779335,8.27900407379798,8.29248048280229,8.29900169680413,8.31378272080826,8.33638866681459,8.3459529258173,8.35942946882091,8.3642121068219,8.36508091782132,8.36464585481987,8.36421207481879,8.35942936281587,8.35290807681266,8.34986492981087,8.34856135880977,8.34812638380893,8.34638793680723,8.34682191280658,8.34899618880675,8.35334292980728,8.35551741480739,8.35638605180675,8.35986432180714,8.36551557880826,8.3698633658088,8.37029756880785,8.36984914880735,8.36855883580585,8.3676890088048,8.36290750580198,8.3589944027996,8.34725653279492,8.34204018079314,8.33421510979055,8.31682589078494,8.30204489678042,8.27769942877276,8.26291850976773,8.24813760376259,8.23379128175742,8.22292321175301,8.2159671237502,8.2107505817477,8.20971867774681,8.21234754374757,8.21572684074852,8.23074625975285,8.238041868755,8.24533758075696,8.25606522575974,8.26808155176326,8.2822426797674,8.2946873317711,8.31528667177697,8.33545600378261,8.34403785578503,8.35635386778848]}]],[[{"lng":[4.72197676990093,4.71740202390168,4.71435257890217,4.71054032190257,4.70444112290354,4.69452956190497,4.68881131190608,4.68604029790659,4.67840795990747,4.67812876590703,4.67577385290686,4.67142713690739,4.672038085907,4.66936970490708,4.66250797290815,4.65755228090883,4.64992803591003,4.64077896291154,4.63658576391255,4.63391681691296,4.628199092914,4.62019342191521,4.61298058991633,4.61001941091768,4.6029661399199,4.60048730492071,4.59763821292184,4.5976004289221,4.59825720492229,4.60170847492177,4.60302198992208,4.60570771892228,4.60631837092283,4.60415097292384,4.60287382892448,4.60227628692465,4.59427125192701,4.58435969992982,4.57521053693252,4.56834799993452,4.56224915393678,4.55881837693835,4.55653141993928,4.56072472193828,4.56796742693684,4.57521063293552,4.58435961993358,4.59617705493099,4.60075191392983,4.60494517092869,4.61752506792562,4.62553030192364,4.644209858919,4.65488343091656,4.66708235991397,4.67546892491262,4.67889977691205,4.67995177491177,4.68685821291027,4.69521559790852,4.70010347390739,4.70324834890668,4.70957495090491,4.71452412690327,4.71911962790182,4.72197676990093],"lat":[7.95898472666557,7.95521721566401,7.95254887666298,7.94683075966088,7.94149393565876,7.93158258865489,7.92853263765347,7.92704060765284,7.91682635464904,7.91090326464715,7.90321450164458,7.89750690564243,7.89460520464159,7.88888681963957,7.88278776663718,7.87745060163511,7.87058865263239,7.86334560862942,7.86334557162909,7.86105859162816,7.85724639962652,7.85000315062364,7.843417993621,7.850548361623,7.85603573262418,7.85879204262486,7.86328490462605,7.86641857262701,7.86990870462818,7.87343230662958,7.88041282763182,7.88949889563493,7.89681913963725,7.90271303163896,7.9060864916399,7.90680359464008,7.91175944464108,7.91671511264187,7.92205243064285,7.92624523464367,7.93501336364596,7.94339993164835,7.94797470964963,7.94759329964984,7.95064300165135,7.95521738765334,7.95788616865489,7.96093569165675,7.96017325065685,7.95864828865666,7.95750481465724,7.95674225865762,7.95483650265843,7.95559891765947,7.95941080466157,7.96627284766437,7.96894117666542,7.9689035396655,7.97055322866657,7.97308871866794,7.97349406466848,7.97353083466873,7.97047090866825,7.96565327666708,7.96117989766602,7.95898472666557]}]],[[{"lng":[5.05493012383044,5.05343960883154,5.04962734383306,5.04429059683477,5.03971568883595,5.03704746583648,5.03247261383735,5.02904167683778,5.02065513083935,5.0149369468403,5.00998164784105,5.00540692584155,5.00197607384155,4.99587682884278,4.98929554584448,4.98749019084476,4.98100944684573,4.97338536984684,4.96957294484769,4.9671063248485,4.96919199284838,4.97071650884872,4.96842954484968,4.96690472485086,4.9608054488528,4.95673851885383,4.94974993685568,4.94517558685718,4.93945744285919,4.92687757786316,4.91315371186686,4.89540809787139,4.88723130987344,4.87770128287574,4.8613091168799,4.85406638388167,4.85177896788188,4.85482882588066,4.85673474487964,4.85749720887889,4.85254148887966,4.85038130888002,4.84339232188126,4.83005002388385,4.8186135118864,4.81289527688823,4.80527117589045,4.79949176189191,4.80105887489177,4.80367047489165,4.8055289618917,4.80462230489294,4.80182189089451,4.79785420789642,4.79696920989757,4.79684610789849,4.79860810589922,4.79849822790007,4.79728273990083,4.79533143890153,4.78026711190596,4.76980512390929,4.75897704291256,4.75628539891328,4.75220575991432,4.74632128591561,4.74244879491684,4.74238643091727,4.74310838491745,4.74610473291721,4.74741889291667,4.75543884691482,4.76717656591247,4.77587130891102,4.78934807790871,4.79804281290785,4.80412910290768,4.80891140490774,4.80630251291035,4.8032598889123,4.80369419691364,4.80456408291405,4.80630259191407,4.82021432891173,4.83716870590802,4.85673194790378,4.86890465790099,4.8850302198973,4.88542419789683,4.88542405789652,4.88368514189603,4.88194655289556,4.88064242689459,4.88064246989381,4.88238091989262,4.88281589389176,4.88803243888967,4.89716200088629,4.8997702688849,4.90498734588302,4.91976836587771,4.93367954187356,4.94411319887011,4.95759016386561,4.9641108118633,4.97802252385941,4.98541314485712,5.00627997385085,5.01193192884921,5.0214958618468,5.04410208084115,5.06192597583704,5.07322944083442,5.08105431383289,5.08931437883148,5.09627012283016,5.10322569682859,5.11278968082673,5.11931073882581,5.12452758182543,5.12800551382512,5.13756955682348,5.14669905782188,5.15322022182035,5.16061056181865,5.16582714981721,5.17321778381537,5.18191255581307,5.18017342181255,5.17756498681232,5.17756518881181,5.17582612281173,5.17533098981176,5.17640681181114,5.17646280781063,5.17303797681127,5.16691887381259,5.16494279381296,5.1640881308131,5.15148108081535,5.13409175681794,5.1275707578188,5.11278972182111,5.09887605882328,5.09439082682417,5.08716059082546,5.08586518982524,5.08366263182561,5.07757654582662,5.07366384882729,5.06975125382767,5.06648547482822,5.06294300282884,5.05493012383044],"lat":[8.04919038071817,8.0577630127207,8.06462485172255,8.06996157472379,8.0718680397241,8.07072453072352,8.06805599772235,8.0638628377208,8.05928796771878,8.05471329471696,8.05013947571522,8.04327687171271,8.03412818470964,8.0322216777086,8.0340395327087,8.032221810708,8.02574161370555,8.01811704570259,8.01735499670207,8.02004633370277,8.02421660470418,8.03260324470692,8.0375594477083,8.046708114711,8.05242636171234,8.05354841471241,8.05547610671248,8.0608130277138,8.06805623571567,8.07987295071846,8.08559121671923,8.08935643071914,8.09092917071907,8.09130962671847,8.09474080671837,8.09550272771809,8.09169096671671,8.08597291371518,8.07911110471312,8.07263085871118,8.06805600870935,8.06661593370879,8.06195641270681,8.0554761767038,8.05356973670234,8.05928790470377,8.06386269870466,8.06501831670459,8.06748135770547,8.07361824770759,8.07860153170929,8.0908053187131,8.10107896871613,8.11286603971958,8.12316152672273,8.13384746472616,8.1472267227305,8.15676780873354,8.16247920673522,8.16551044173609,8.17564350873822,8.18544744574063,8.19371981374252,8.19445228874258,8.19524388774251,8.19433720374184,8.19772741074265,8.20307049974436,8.2068956107456,8.21234754374757,8.20971867774681,8.2107505817477,8.2159671237502,8.22292321175301,8.23379128175742,8.24813760376259,8.26291850976773,8.27769942877276,8.30204489678042,8.31682589078494,8.33421510979055,8.34204018079314,8.34725653279492,8.3589944027996,8.36290750580198,8.3676890088048,8.36855883580585,8.36984914880735,8.36551578580599,8.36160270380473,8.35073470980111,8.33943180979741,8.32421587379246,8.31465245078942,8.30508812878647,8.29552361978342,8.28509052278047,8.27030952977639,8.26074492077354,8.25292004877139,8.23118303276548,8.22118470576327,8.20901212576018,8.19336142275618,8.18423180775376,8.17640680275229,8.1703206167509,8.15423500674732,8.15032303974648,8.14858337874662,8.14423648474687,8.14510623174837,8.14510641474916,8.1485833147508,8.15466973175328,8.15858265975496,8.15901754975559,8.16336441975761,8.17075534076039,8.18031980076371,8.18684008376595,8.19379615776879,8.1998824527713,8.19988261077179,8.19988239077229,8.19727410377186,8.19596956577197,8.19249157977148,8.18205842876811,8.17162500776469,8.16597268276297,8.15988719876098,8.15899616976067,8.15440168575933,8.14905880975765,8.14673292075672,8.1455242227559,8.14465646475552,8.14380179975517,8.13554185675175,8.11858756574529,8.1111966037425,8.09772009273733,8.08501651573239,8.08292786973141,8.07827073872947,8.0728642937277,8.0707664507269,8.06641971972512,8.0633764407239,8.05685517772158,8.05446807872063,8.05283361571985,8.04919038071817]}]],[[{"lng":[4.54334925493548,4.53785184893591,4.52984661593735,4.52184106193882,4.50697371194154,4.5012554389426,4.49286892594361,4.4867696419441,4.48518328894428,4.48143291494469,4.47685806794541,4.47304623994631,4.47075895394705,4.46656559494845,4.46199085595002,4.46084739595084,4.4616098659511,4.46542170395071,4.46479462295162,4.46885296295107,4.46968596895094,4.4711091029506,4.47242830295029,4.47375276694993,4.47621992394899,4.47778061294843,4.47998988594783,4.48108367994765,4.48237843394748,4.48277740994773,4.48623001994735,4.48750575394741,4.48985113894736,4.49264694294717,4.49479698894701,4.49848050894652,4.50305184194577,4.50854321994455,4.51250352494355,4.51803243094199,4.5276562549396,4.53324189293861,4.53672556293802,4.5396003199376,4.54302838393683,4.5428750389368,4.54276338093652,4.54266114493611,4.54269699293582,4.54334925493548],"lat":[7.87124484362436,7.861820687621,7.85610280661857,7.85152809361649,7.84276060161257,7.83894838761093,7.82827415760691,7.81798160060317,7.81571472360232,7.81035744760035,7.80654534159879,7.80616438259839,7.80845168659892,7.81264497059991,7.81798163160124,7.82370002360296,7.82865578460461,7.83437403560668,7.84262510060926,7.84695378161095,7.84773464561124,7.84782707961139,7.84784333461149,7.84742136861149,7.84350658861043,7.84177235960999,7.84092268060989,7.84137441361015,7.84336305961085,7.84665555161194,7.85195826861389,7.8554808096151,7.86142718361712,7.86650248461898,7.87047399862034,7.87490258262207,7.87868468262364,7.87919011262419,7.87901921962443,7.87645667462406,7.87530285262444,7.87887734962598,7.8817251706272,7.88439457862823,7.8849883386287,7.88423000062842,7.88067346662731,7.87634389962592,7.87340745862502,7.87124484362436]}]],[[{"lng":[8.55458898824537,8.55491910024529,8.55700300224489,8.56000947324439,8.55953097924449,8.55416871024561,8.55130969624617,8.54761682724691,8.54583010924726,8.5442815202476,8.54296943724786,8.54320506524787,8.54391549524771,8.54367585524775,8.54021849724848,8.53843109924887,8.5372372092491,8.53783114124901,8.53832608424889,8.53937547024872,8.5460329852474,8.54864847124692,8.54941464524675,8.55185522224629,8.55553960024551,8.55758687724506,8.55985521724456,8.5610505662443,8.5621234742441,8.56319525824387,8.56664718524319,8.57319523124185,8.57784095324093,8.58105796024026,8.58308359823986,8.58344362423979,8.58547276623932,8.5886913052387,8.59322103023776,8.59536638823726,8.59632056323706,8.59639407223703,8.60087560023614,8.60421250723541,8.60579799523513,8.61021806423422,8.61231284423378,8.61301250123362,8.61299586223362,8.61046549123405,8.60884437823433,8.60838418823438,8.60885530623426,8.60978764823405,8.60799910123441,8.60579297523485,8.60294178223538,8.60242287023552,8.60021571423589,8.59465219323696,8.59159752523763,8.58990214423794,8.58343293723932,8.58161548023968,8.57625290324077,8.57315534124142,8.57089120224191,8.57005423724208,8.56516724124312,8.56254365524364,8.56396898324342,8.56741173124278,8.56657652224296,8.5652667192432,8.56383809224349,8.56133721124399,8.55955202924436,8.55657463124497,8.55458898824537],"lat":[11.9944124510163,11.9959603500168,12.0030296860187,12.0107707310208,12.0109328790209,12.0129208860215,12.0135044720216,12.0140864470219,12.0143187420219,12.014434371022,12.0161926860225,12.018070423023,12.0213566900239,12.0226468190243,12.025107012025,12.0258087710252,12.0279192070258,12.0294453960262,12.0303482990264,12.032263203027,12.0422444920297,12.0462370370307,12.0467611360309,12.0503489080319,12.0448566090303,12.0422584170295,12.0380372930284,12.0341668660273,12.033346635027,12.0334648640271,12.0354638520276,12.0378178150282,12.0377061500281,12.0366538390278,12.0357171150275,12.0333711280268,12.0298535510258,12.0273926550251,12.0242297690242,12.0228241630238,12.0214172720234,12.0177274210224,12.0149497070216,12.0130973010211,12.0127594300209,12.0120765010207,12.0111622750204,12.0095584620199,12.0058334840189,11.9985560900169,11.9921378440152,11.9870954190138,11.9820539730124,11.9799927540118,11.9778795210112,11.9743098610103,11.9712643560095,11.9707095630093,11.9671404220083,11.9601805400065,11.9597800080064,11.962140355007,11.9651163000079,11.9663713450083,11.9697682020093,11.9711726100097,11.97234348101,11.9750408940108,11.9785556440118,11.9814853980127,11.9850075040136,11.993811202016,11.9949837050163,11.9949821770164,11.9946285070163,11.9946255650163,11.9936850260161,11.9936814870161,11.9944124510163]}]],[[{"lng":[7.49322846733587,7.49600078933555,7.5019795553353,7.51849692833393,7.53458723233082,7.54644365332826,7.56621229532382,7.58005469632067,7.58598051931942,7.61952674331303,7.65111743030665,7.68074410030056,7.69585121829747,7.69822576129689,7.70967826329468,7.72553582529157,7.74315505328747,7.75989351928373,7.79160815827686,7.80658478727337,7.83125198126735,7.83741833126552,7.8453472952636,7.86120527726019,7.87618162825662,7.89996758625124,7.91494402924823,7.92819456924526,7.9278110332453,7.9187797242449,7.90659926424247,7.90662066324194,7.91120630624047,7.93539776423357,8.04325661420233,8.08453299219129,8.06532587219422,8.05827833819461,8.06109690719349,8.06603047719227,8.07801151618925,8.09140178618636,8.09985925718489,8.11536507618179,8.12946062117829,8.14637489917469,8.15624127717227,8.1639939321695,8.1618797951682,8.16610802716582,8.16822232416357,8.16822230416156,8.16258411216066,8.15271765216182,8.13509860616434,8.11254521616788,8.09422104217032,8.08435448717208,8.06180177817546,8.0596875791752,8.04982097317521,8.04770655717336,8.05052568317107,8.052639798169,8.05545925916649,8.06109713616261,8.0629161181618,7.96490202118451,7.91804146319546,7.87990733020413,7.87034842820606,7.8672597482068,7.83841776421267,7.8109722352188,7.7825954812253,7.76073225123021,7.73840297523506,7.69746667924412,7.67683773324849,7.67722583024862,7.66567591925122,7.62491403626053,7.58347253726986,7.54271052327883,7.505345101287,7.45099565929829,7.4457867432993,7.43244234430216,7.40448517630782,7.40088328730914,7.39366390131234,7.38965322731466,7.3832362993173,7.3816319043188,7.38163194332094,7.38804920932155,7.39286173332239,7.39927920632212,7.40890469232169,7.41612413732179,7.42574932732066,7.43296855731999,7.43216622532056,7.43136423032153,7.43216586232197,7.43457282532215,7.43216610032327,7.43216620732396,7.43697867432365,7.44259414132307,7.44259387432392,7.43858310832554,7.43136393032907,7.43184703633013,7.43610692932989,7.44592942432868,7.49411642632161,7.52757915531635,7.54630257431303,7.58374690730642,7.59159839730565,7.59057706430647,7.57473215731075,7.56480579931385,7.54893539931849,7.52604004232664,7.51878497832945,7.51767904232988,7.51711716733008,7.51237926433153,7.4995452713345,7.49322846733587],"lat":[8.65073673205119,8.65430174305235,8.66865155705653,8.69868651006563,8.70275521406761,8.70182002506807,8.69796888606815,8.69409389306789,8.69411668706825,8.70308330007256,8.70712893007545,8.70821835907742,8.70910681807852,8.70825201207842,8.71089545107977,8.71353826308135,8.70737163908076,8.70384787208073,8.69944288908139,8.69415655308086,8.68094241207873,8.67301372407701,8.66948981307653,8.66772744207701,8.66067968107599,8.65451330107578,8.65539463307688,8.65193572207675,8.65155201807663,8.61910382406761,8.55033362604904,8.54320089304721,8.5354332190455,8.50956661304027,8.38665901701563,8.3518872350095,8.33930218700511,8.32520668400116,8.31815901199958,8.31534004999915,8.30829249899819,8.30617808899854,8.30899704099978,8.30970203800097,8.30194951599993,8.29983520500055,8.29419720299978,8.27869119999647,8.25684357199089,8.23711002498633,8.21314709298056,8.18777560697436,8.16169930696761,8.1511279409644,8.13773627995991,8.12505045695524,8.10884082695003,8.10531716894848,8.09051691094333,8.08205899394113,8.0573921069344,8.02920147292739,8.00805763892248,7.98832420091785,7.96506644391244,7.93264727290504,7.92698881190382,7.95957629490455,7.97571384990509,7.98536301390476,7.98533376790401,7.98621601690404,7.98528569590173,7.99133295190124,7.99877657390103,8.00342852590064,8.00621891089976,8.01366239689868,8.01447117689741,8.01662625289799,8.01934345989784,8.02953420589747,8.0376861928966,8.04312135789508,8.04719821989345,8.04651837588943,8.04486092288863,8.04569236488789,8.0429649138852,8.05016903588682,8.07022181289146,8.08786863989575,8.10391148089946,8.11835010390307,8.14482019390992,8.16888441391664,8.19214524992305,8.20578191192706,8.22583486693294,8.24588877193867,8.25792020694244,8.2683486479457,8.27396307094712,8.28358842694955,8.29160975195173,8.30043327895421,8.30845448895614,8.31727796595849,8.32610126196113,8.33412260896361,8.34535315596655,8.35497847296886,8.38144886897538,8.3969124839795,8.40573680398214,8.4165822659856,8.45803385399966,8.48174117700802,8.48967290701127,8.50651561801801,8.51833169302163,8.52716724302392,8.53987434902633,8.55358605302938,8.57218489503341,8.6182554410444,8.63608769604875,8.63880621804942,8.64018648704974,8.64695461605131,8.6501626650514,8.65073673205119]}]],[[{"lng":[8.19191889704693,8.18823885404768,8.16870144805218,8.15986276805433,8.14962887205654,8.12915989606125,8.12347317106251,8.11672390506399,8.11281007806483,8.10970817806533,8.10914370206546,8.1049888750663,8.1021759280669,8.10031813006868,8.09985355506951,8.10078336606979,8.1026437540697,8.11008732506836,8.13520692206336,8.14358068906193,8.15288421206045,8.16451431305839,8.17599337805653,8.19445011505412,8.19984417305465,8.19980859005629,8.20085928805766,8.20191956305867,8.20624729005854,8.22579773405463,8.24811047405091,8.25103834405065,8.26918147504888,8.274763221048,8.2761592850475,8.28360156504512,8.29430090904238,8.29848772304107,8.31290936803743,8.33430765703246,8.34678324602949,8.36701759102529,8.37897223302246,8.39853967401749,8.40180679501633,8.4103861260129,8.40780743401212,8.40548147801003,8.40548152300895,8.40175939400886,8.39385111100925,8.3873388970097,8.38361723400972,8.37896541700949,8.36647535205504,8.36203861603775,8.36185765903763,8.34451834803683,8.33692863903666,8.31631061503697,8.28052345903674,8.27293313303664,8.26533918903672,8.25991178503691,8.25555630003756,8.25445126203839,8.25116571303963,8.24788436804068,8.24352423904155,8.23271167472362,8.21420319404228,8.20545096104408,8.19191889704693],"lat":[6.96938505470055,6.96978270770034,6.97536525169967,6.97908695569961,6.98048217869892,6.9865298126983,6.98795287569807,6.98901554469769,6.9891408746973,6.9884591426969,6.98822237869677,6.98860024669652,6.98888385569632,7.00281133369903,7.00978891970045,7.01444096870152,7.01723198970228,7.01862766770326,7.01955782170576,7.02188383970698,7.02607059770871,7.02839658771029,7.03279708071225,7.04562341071661,7.06190834772047,7.07818108972389,7.09445646672739,7.10639238573,7.113995918732,7.11403770873377,7.12151804273732,7.12468998473825,7.14376318674389,7.14655393374499,7.14422800874464,7.13492451674334,7.12887675074303,7.12375976274233,7.11631668974208,7.10933931874254,7.10417654174258,7.10237502574403,7.09805600174422,7.08724007774371,7.08182087274294,7.06420082474007,7.05165578473726,7.02607067073186,7.0149059117296,7.00699796672765,6.99536809272457,6.98699479072228,6.97955176872042,6.96838761771772,6.95161438988645,6.94886149711917,6.9472295831191,6.92984102011752,6.92440306211689,6.92002569211516,6.90151409111209,6.89715961311146,6.89497485911084,6.89496394111042,6.90146423411015,6.91122608211017,6.92532269311013,6.93724968711006,6.94591970310984,6.95780313742541,6.96750520670224,6.96792234970151,6.96938505470055]}]],[[{"lng":[9.00857617101032,9.00898831500997,9.00939248900967,9.00951213400914,9.00973777500815,9.00988289400754,9.01017977500732,9.01189623800604,9.01282594600535,9.01307487600469,9.01329431000414,9.01597011400207,9.01952116200025,9.02070395399905,9.01715275299943,9.00294869800166,8.98874519300389,8.97454201100643,8.95915523600906,8.95642234000959,8.95995309900901,8.9608391410092,8.9615189710096,8.96165820800984,8.95912265801113,8.95470881801201,8.94440953901393,8.9296958770165,8.91547406601914,8.89095196602388,8.88408579402545,8.88171536502594,8.84077600703577,8.83130423703789,8.82183516303954,8.8076339520418,8.80053418904286,8.78757601404456,8.76736193004764,8.74480152705161,8.72714627505502,8.69330608306182,8.66142741506852,8.64230085007218,8.62170241807603,8.59667076308046,8.58868889108219,8.55316512909029,8.54249556909341,8.53063924609693,8.51995620810079,8.50690869710479,8.50405203510542,8.49150552210856,8.46508188311446,8.45948624311771,8.45353419812047,8.44353022912403,8.45085837912217,8.4550213351212,8.45718618212069,8.45984899712015,8.46167814111983,8.46500500811922,8.46966383911827,8.47498820511724,8.48297584411558,8.4896330521142,8.4932159921134,8.50325597311105,8.52220818710694,8.53641725810408,8.53980162410327,8.54341316610248,8.54423426910224,8.54760001310146,8.54883226410114,8.55022711610082,8.55137498610065,8.55235749410053,8.55342259810045,8.55481544810022,8.55571632210015,8.55784913909973,8.55875186909956,8.55875107809956,8.55792879809987,8.55735275510008,8.55743252910022,8.55890242410036,8.56004665010033,8.56011162310038,8.56480586410026,8.56536642210051,8.56657828610058,8.56853828510036,8.57376920809944,8.58575811809719,8.60581104509368,8.61627155709194,8.62193661709112,8.62433175609085,8.62585584409072,8.62781523609057,8.6306459770903,8.63413277008973,8.64293028108809,8.64523047508761,8.64745112608718,8.65091730008647,8.65750432308516,8.66486082508355,8.67285078008205,8.67638693208136,8.68055461708053,8.68557095207959,8.69363213307811,8.69718461107741,8.7006627070768,8.70299315807635,8.70605728607578,8.71122642707463,8.71537580907368,8.71922751207276,8.72469448607145,8.7285851550703,8.73254107706913,8.73931192306764,8.74921587906548,8.75303477606454,8.75902466506298,8.76058559006255,8.76362330006175,8.77079464405987,8.77561374805875,8.7806033370573,8.78528388105626,8.79588132005374,8.80169197805235,8.8035182360519,8.80904862405055,8.81373615804948,8.81892285504826,8.82547884404672,8.82940214204575,8.83302487304497,8.83648293104431,8.83921075704377,8.84118530204334,8.84754840804193,8.85686691404006,8.86322711703887,8.86662014703829,8.87151440503736,8.8747538160367,8.87811634903608,8.88286014603508,8.88528712603469,8.89414025003328,8.90135010503178,8.90591040603087,8.90930774403019,8.91134628102975,8.91424732902916,8.92209449202745,8.92738750602642,8.93029804402591,8.93386553702524,8.93599706302482,8.94182500302375,8.94514550702312,8.94756043802268,8.95218641502177,8.9556569140211,8.9598524970203,8.96375002301952,8.96755497801872,8.96958152101831,8.97239683401775,8.97771280401656,8.98143770401575,8.9881106340144,8.99511343101304,9.00087158801189,9.00857617101032],"lat":[8.40040402507962,8.39678476707879,8.393236151078,8.38654326607644,8.37389665207352,8.36577233407164,8.36359608807118,8.35100931906838,8.34419263806682,8.33597562206494,8.32873709206329,8.30830535705876,8.29298527105549,8.28002235005259,8.27648718305155,8.26941659404899,8.26234573004643,8.2588096700447,8.25409467104262,8.25409435704241,8.25554654204298,8.26032834004415,8.26713181304575,8.2708121340466,8.28141678004893,8.28141682004862,8.2799452740476,8.27602200004575,8.2745505600445,8.27307990104256,8.27602205104276,8.2762671180427,8.30002203104559,8.30355315704579,8.30119188404461,8.29411404104204,8.28939637904046,8.27803091203699,8.26572323303279,8.2593470750298,8.25836663602842,8.25983810002657,8.26474189802563,8.26327033102402,8.25983813002186,8.25301124501858,8.25504529501856,8.26796702801929,8.28091677002168,8.29622179302463,8.31859862902929,8.33743663003301,8.33822225203298,8.34684316003428,8.35459547503447,8.38332943504112,8.4045326410459,8.42513088105035,8.42017965404954,8.41819863304931,8.41687721804917,8.41671527404929,8.41738054704954,8.41821327904995,8.41838560405027,8.41855880205068,8.41823896005109,8.41708922005121,8.41593991705117,8.41167375905075,8.40698497105079,8.40700314005172,8.40553217005156,8.40398515805142,8.40349651605136,8.40186777405114,8.40039943905088,8.4001561590509,8.40081084005115,8.40203661905149,8.40350777905191,8.40489737305232,8.40604140105266,8.40596230705277,8.40604505205288,8.40669831205303,8.40816689505335,8.40979907805368,8.41143234505406,8.41723100005559,8.42049815505646,8.42124078505663,8.43178536305949,8.43743006606087,8.44122506306187,8.44339709706252,8.44513892706329,8.44775635706465,8.45363684406732,8.45907209006927,8.46320042207061,8.46624060907151,8.46862889507216,8.47188534407306,8.47557694607413,8.47753314907484,8.47896698207569,8.47890478407585,8.47884477307595,8.47875115507615,8.47857283407648,8.47661105007646,8.47746759607717,8.47784707007748,8.47759161307769,8.47844782707822,8.479824174079,8.4804306340794,8.48102487007973,8.48144917707998,8.4820060120803,8.48010145408018,8.47857295808007,8.47634232307972,8.47317789307932,8.46806994507835,8.46287835907732,8.46088697907726,8.45797450507714,8.45491985307665,8.4501277420759,8.44869621107567,8.44591247807519,8.43933773407403,8.43721109907385,8.43099987907267,8.4286051600724,8.42318332207174,8.42021092107138,8.41899294907125,8.4153059870707,8.41292757507045,8.41029562107011,8.40696917206975,8.40402593106927,8.4038447870695,8.40367227406968,8.40353587206981,8.4029549460698,8.40108401606975,8.40059272907018,8.40162081407084,8.4021690850712,8.40295972807165,8.40284359207186,8.40297808307208,8.40206443207214,8.40333075807259,8.40794949307424,8.40704817507449,8.40647804707465,8.40607823707473,8.40583883907484,8.40549763807491,8.40304568207487,8.40370737607533,8.4040707350756,8.40451612807593,8.40479482307609,8.40555473007667,8.40600479007696,8.40605176907713,8.40614224607744,8.40620993607766,8.40629208007797,8.40604975707814,8.40581219907835,8.40568636007843,8.40481292507838,8.40319735507832,8.40206423407833,8.40165621707862,8.40122801207896,8.40087513607928,8.40040402507962]}]],[[{"lng":[3.34169247507823,3.33980057807851,3.33542466707928,3.33456087207937,3.3338383690796,3.3330667730798,3.33186456708,3.33176289507992,3.33110491508009,3.33033682408025,3.32914136508038,3.32882094608039,3.32794771108056,3.32607907608099,3.32520071908114,3.32466156408117,3.32407738408109,3.3210644830816,3.31645892308256,3.31893945608249,3.32686852808158,3.32829166808194,3.3284950020823,3.32686854008314,3.32442876808434,3.3223958410855,3.32331064708603,3.32354770908607,3.32392803208589,3.32417054308578,3.32447981908564,3.32496988208546,3.32548708208528,3.32620849308513,3.326838230085,3.32756618208484,3.32824529308464,3.3303080750844,3.33174495408424,3.33213531608416,3.3339780950839,3.33447225708387,3.33510699008396,3.33725782708369,3.33841846208344,3.34106337908281,3.34354289308224,3.34590198408169,3.34679042808142,3.34846625108108,3.34900329308108,3.34910684708113,3.34955659808109,3.35018938108101,3.35102554008083,3.35153310408068,3.35248371108043,3.35319428508026,3.35372591408008,3.35474266707986,3.35540197707972,3.3561950330795,3.3567039030794,3.35763892007906,3.35808434107892,3.35923556907863,3.36027468307834,3.36081529907822,3.36183789907811,3.36253106307817,3.36252418407832,3.36286328307837,3.36344721407832,3.36552290407777,3.36651397707719,3.368344050077,3.37202932907504,3.37115315007491,3.36922071107509,3.36887667707475,3.37050957707392,3.37132898207349,3.37109423807332,3.37006433407338,3.36810965907374,3.36590013007405,3.36447967107421,3.36399008007402,3.36455858007353,3.36487625707301,3.36505836207258,3.36303447707318,3.36025761007394,3.35779813507469,3.35113359507637,3.34681234607735,3.34616002607752,3.34564823307768,3.3453741210777,3.34523672007765,3.34487928607771,3.34377037707785,3.34169247507823],"lat":[6.47490693308284,6.4733934060822,6.47046369308084,6.46985769908055,6.46994966208054,6.46993771908045,6.46925722808009,6.4687039950799,6.46847308807976,6.46824075207959,6.46711891907917,6.46645207607891,6.46588687107866,6.46552697307834,6.4652929350782,6.4645121820779,6.46250222607724,6.46038818207629,6.45903815807534,6.46361771007697,6.47195341008035,6.47784957908224,6.48130570008329,6.48476173208416,6.48964109008532,6.4951304270867,6.50102663408859,6.50191940708886,6.50118202508867,6.50071184208855,6.50022998908844,6.49999425308845,6.49962469408842,6.49961072208846,6.49988529908864,6.5002023650888,6.49982966208878,6.50212901108968,6.50341002509019,6.50385750509036,6.50529937209104,6.50616842709136,6.50794486709191,6.51016413609283,6.51075635709311,6.51099592609351,6.51123292009383,6.51140189709412,6.51104032009414,6.51186118109459,6.51281903909492,6.51326237109504,6.51415246309538,6.51462600109558,6.51479350009571,6.51480133109577,6.51470547909583,6.51442960009587,6.5143052420959,6.51421042309596,6.51439722609611,6.5144979080962,6.51441729509621,6.51390181109621,6.51364358009616,6.5134185600962,6.51330201109629,6.51328631609635,6.51444523609683,6.51642572209747,6.51773099609786,6.51864170509815,6.51942364409849,6.5193671350987,6.51647798909793,6.51856185709874,6.50981260009658,6.50736697209572,6.50470473309476,6.5014089860937,6.49788023309283,6.49591849909238,6.49407198409179,6.49260831909123,6.49139381909065,6.48964860208988,6.48791553708921,6.4855388480885,6.48278364608774,6.47923468608674,6.47594675208578,6.4764938110857,6.47728672508561,6.47855676508572,6.47863570408499,6.47780708808429,6.47806322108429,6.47826446008427,6.47787022208417,6.47730738608395,6.47679006508375,6.47597568208341,6.47490693308284]}]],[[{"lng":[4.37529342001472,4.37561819201453,4.38173512001182,4.38255841801145,4.3868520260098,4.40381414500459,4.42137616599967,4.44175958999329,4.46010499398746,4.47709139598188,4.48388626697893,4.49000114997574,4.49407822597342,4.49407820497196,4.49407815297059,4.49496413196944,4.49543720596885,4.50562904596422,4.5334867949558,4.55726808094896,4.56899831394579,4.56072478994769,4.55919976094763,4.56034329194671,4.5630116739454,4.56301167694459,4.56301161294411,4.56301165294317,4.55996222494259,4.55755002794213,4.55567232994232,4.55074839994324,4.54690837494389,4.54289633694465,4.53889000594544,4.53489317394608,4.53089641194678,4.5265732519476,4.52548240594786,4.52488533694793,4.51609771394965,4.51208837295046,4.50945835595101,4.50706188295147,4.50126238895294,4.49510486095439,4.49268860395495,4.48962866695556,4.48833091195571,4.48704129795577,4.48574344095593,4.48400869195618,4.48246820595647,4.46885305195979,4.45817905996225,4.45631962096265,4.44709446496476,4.44270190296575,4.43479360396757,4.4321574409682,4.42931789996873,4.42912272696859,4.42959263996827,4.43161561596751,4.43610679796574,4.43812691196496,4.44012977496403,4.43998585396401,4.44023731496347,4.44028110796317,4.43945631796294,4.43820005896278,4.43694644596264,4.43631978196251,4.43502238196266,4.43108663996343,4.42778863196427,4.42269316396573,4.42003266696657,4.41627003396764,4.41009155896926,4.40657363897012,4.40282747097106,4.39644272197264,4.39246479197356,4.39118512097377,4.38530390697478,4.38225620097527,4.38073923897549,4.37166868097646,4.3697371719766,4.36564979297696,4.3632574499787,4.36020752898046,4.35143992398379,4.3483900899853,4.33809751098881,4.33542924699011,4.3281860119929,4.31598710299656,4.30711075499883,4.29539581000257,4.29387714000321,4.2858715860059,4.27653036000866,4.27745042300914,4.27652249600973,4.27557753301036,4.27375277701129,4.26926039701303,4.26784990101399,4.26531673201538,4.26168367701701,4.25761914701871,4.25536831101963,4.24984841402178,4.25154864802133,4.25228001002145,4.26051909902053,4.26795212401956,4.27709639601791,4.28004692601755,4.28238251901718,4.28371264301699,4.28948989001628,4.29688120901556,4.30171206001579,4.30067903901739,4.29974286601825,4.29705235202006,4.28683964402341,4.2723750050282,4.26052538603173,4.25191347303519,4.24927518503665,4.24970026303714,4.24996236303744,4.26239227103551,4.27979580003277,4.3114103160271,4.33634320002277,4.34967172702026,4.37529342001472],"lat":[8.31818662275678,8.31682981175636,8.30143205775169,8.29935949375106,8.29188884074889,8.2787238337457,8.27046401974419,8.25299179673981,8.23600591873549,8.21834003573095,8.20271213072629,8.18232812272008,8.1667002947153,8.14971359270979,8.1334067517045,8.12277506370114,8.11709987869936,8.09195905069195,8.07157515168738,8.05866531668501,8.05475606068457,8.05395124268376,8.04899499968202,8.04137122867967,8.03412811167757,8.02459806667452,8.0192612506728,8.00896824566953,7.99410099966457,7.98203982366058,7.97960473565963,7.9762991556582,7.97316092465693,7.9714120116561,7.96919940165508,7.96621401465381,7.9632282886526,7.9609523526515,7.96037814565125,7.96006371665114,7.95562832064905,7.95372225964815,7.95281017664765,7.95195406264721,7.95252460564694,7.95244919864646,7.95220029164618,7.95062861964543,7.94885926464481,7.94643243964395,7.94466307364327,7.9426693456425,7.94187812264211,7.94225649764123,7.94149403664016,7.9407939886398,7.93980298863879,7.93931027763831,7.93855456063746,7.93830281963719,7.93673309963651,7.93475822963583,7.93235307063512,7.92887136863411,7.92147514163213,7.91821263763123,7.91350167362985,7.91249446962956,7.90771852962805,7.90421220162692,7.89981853562546,7.89476192462377,7.889486070622,7.88684829162111,7.88507874262043,7.88327639861956,7.88323538561931,7.88624053761983,7.88796083362021,7.88988635662054,7.89156268962058,7.89151874062032,7.89212947262022,7.89270712661989,7.89249197561956,7.89110680661901,7.88664956761711,7.88420027761608,7.88242777461541,7.86938230761056,7.86563209960923,7.85946825960694,7.87211371061077,7.88278773761394,7.89612995761757,7.90489754462012,7.91633417562304,7.92319595162504,7.93501321162828,7.94301900762996,7.94446366962974,7.9545511276321,7.95750474563293,7.96551037563493,7.97111533263606,7.97930600663877,7.9830202336399,7.98804911864146,7.99306667364296,8.00024163964499,8.00723722064718,8.0159714976498,8.0246918596524,8.03274875465471,8.03666486765583,8.04584087365844,8.04548020465842,8.04938535265975,8.06119709866424,8.07048976966779,8.07729578067066,8.08108807267213,8.08337586667309,8.08490560667365,8.09250426567656,8.10514015268121,8.12108753868683,8.13612382169166,8.14363644769406,8.15697947069825,8.16771766870108,8.18258149970498,8.18995387070655,8.20656429571146,8.21572711571429,8.22297459171675,8.22744107471824,8.2401425747233,8.25792384573038,8.28090227474018,8.30128481674861,8.30981417475231,8.31818662275678]}]]],["bassa","bassa.1","ifelodun","ifelodun.1","irepodun","irepodun.1","nasarawa","nasarawa.1","obi","obi.1","surulere","surulere.1"],"nigeria[nigeria$shapeName %in% duplicate_area, ]",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#666666","weight":1,"opacity":1,"fill":true,"fillColor":["#D9D9D9","#D9D9D9","#D9D9D9","#D9D9D9","#D9D9D9","#D9D9D9","#D9D9D9","#D9D9D9","#D9D9D9","#D9D9D9","#D9D9D9","#D9D9D9"],"fillOpacity":[1,1,1,1,1,1,1,1,1,1,1,1],"dashArray":"none","smoothFactor":1,"noClip":false},["<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>bassa<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>shapeName<\/nobr><\/td><td align=\"right\"><nobr>bassa<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>bassa<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>shapeName<\/nobr><\/td><td align=\"right\"><nobr>bassa<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>ifelodun<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>shapeName<\/nobr><\/td><td align=\"right\"><nobr>ifelodun<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>ifelodun<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>shapeName<\/nobr><\/td><td align=\"right\"><nobr>ifelodun<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>irepodun<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>shapeName<\/nobr><\/td><td align=\"right\"><nobr>irepodun<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>irepodun<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>shapeName<\/nobr><\/td><td align=\"right\"><nobr>irepodun<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>nasarawa<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>shapeName<\/nobr><\/td><td align=\"right\"><nobr>nasarawa<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>nasarawa<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>shapeName<\/nobr><\/td><td align=\"right\"><nobr>nasarawa<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>obi<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>shapeName<\/nobr><\/td><td align=\"right\"><nobr>obi<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>obi<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>shapeName<\/nobr><\/td><td align=\"right\"><nobr>obi<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>surulere<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>shapeName<\/nobr><\/td><td align=\"right\"><nobr>surulere<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>surulere<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>shapeName<\/nobr><\/td><td align=\"right\"><nobr>surulere<\/nobr><\/td><\/tr><\/table><\/div>"],null,["bassa","bassa","ifelodun","ifelodun","irepodun","irepodun","nasarawa","nasarawa","obi","obi","surulere","surulere"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[["Esri.WorldGrayCanvas","OpenStreetMap","Esri.WorldTopoMap"],"nigeria[nigeria$shapeName %in% duplicate_area, ]",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[6.45903815807534,12.0503489080319],"lng":[3.31645892308256,9.02070395399905]},"fitBounds":[6.45903815807534,3.31645892308256,12.0503489080319,9.02070395399905,[]]},"evals":[],"jsHooks":[]}</script>
</div>
<details><summary>Show the code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">tmap_mode</span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We will now access the individual index of the <code>nigeria</code> data frame and change the value. Lastly, we use the <code><a href="https://rdrr.io/r/base/length.html">length()</a></code> function to ensure there is no more duplicated shapeName.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria</span><span class="op">$</span><span class="va">shapeName</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">94</span>,<span class="fl">95</span>,<span class="fl">304</span>,<span class="fl">305</span>,<span class="fl">355</span>,<span class="fl">356</span>,<span class="fl">519</span>,<span class="fl">546</span>,<span class="fl">547</span>,<span class="fl">693</span>,<span class="fl">694</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bassa kogi"</span>,<span class="st">"bassa plateau"</span>,
                                                                               <span class="st">"ifelodun kwara"</span>,<span class="st">"ifelodun osun"</span>,
                                                                               <span class="st">"irepodun kwara"</span>,<span class="st">"irepodun osun"</span>,
                                                                               <span class="st">"nassarawa"</span>,<span class="st">"obi benue"</span>,<span class="st">"obi nasarawa"</span>,
                                                                               <span class="st">"surulere lagos"</span>,<span class="st">"surulere oyo"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="op">(</span><span class="va">nigeria</span><span class="op">$</span><span class="va">shapeName</span><span class="op">[</span> <span class="va">nigeria</span><span class="op">$</span><span class="va">shapeName</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">nigeria</span><span class="op">$</span><span class="va">shapeName</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">$</span><span class="va">shapeName</span><span class="op">)</span><span class="op">]</span> <span class="op">]</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section><section id="projection-of-sf-dataframe" class="level4"><h4 class="anchored" data-anchor-id="projection-of-sf-dataframe">Projection of sf dataframe</h4>
<p>Since our aspatial data was imported to a tibble dataframe, we will need to convert it to an <code>sf</code> object. First, we rename the columns for ease of representation using the <code>rename()</code> function from <code>dyplr</code>. We then only retain the columns required for analysis such as the name of the <em>latitude</em>, <em>longitude</em>, <em>status</em>, <em>water_tech_category</em>, <em>usage_capacity</em>, <em>is_urban</em> and <em>water_point_population</em>.&nbsp;</p>
<p>We realised there were <strong>NA</strong> values within the multiple columns, so we will replace the NA values with <code>Unknown</code> and <code>0</code> using the <code>mutate()</code> function.</p>
<p>We will then use the <a href="https://www.rdocumentation.org/packages/sf/versions/1.0-9/topics/st_as_sf"><code>st_as_sf()</code></a> function to convert the dataframe to an <code>sf</code> object. We will have to input the column that specify the longitude and latitude, and lastly, the CRS projection of the coordinates.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeriaT</span> <span class="op">&lt;-</span> <span class="va">nigeria_attribute</span>  <span class="op">%&gt;%</span>
  <span class="fu">rename</span> <span class="op">(</span><span class="st">"status"</span> <span class="op">=</span> <span class="st">"#status_clean"</span>,
          <span class="st">"lat"</span> <span class="op">=</span> <span class="st">"#lat_deg"</span>,
          <span class="st">"long"</span> <span class="op">=</span> <span class="st">"#lon_deg"</span>,
          <span class="st">"water_tech"</span> <span class="op">=</span> <span class="st">"#water_tech_category"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span> <span class="op">(</span><span class="va">status</span>,<span class="va">lat</span>,<span class="va">long</span>,<span class="va">water_tech</span>,<span class="va">usage_capacity</span>,<span class="va">is_urban</span>,<span class="va">water_point_population</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>status <span class="op">=</span> <span class="fu">replace_na</span><span class="op">(</span><span class="va">status</span>, <span class="st">"Unknown"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span> <span class="op">(</span>water_tech <span class="op">=</span> <span class="fu">replace_na</span><span class="op">(</span><span class="va">water_tech</span>, <span class="st">"Unknown"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>water_point_population <span class="op">=</span> <span class="fu">replace_na</span><span class="op">(</span><span class="va">water_point_population</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="va">nigeriaT_sf</span> <span class="op">&lt;-</span> <span class="fu">st_as_sf</span><span class="op">(</span><span class="va">nigeriaT</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"long"</span>, <span class="st">"lat"</span><span class="op">)</span>,  crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We will now transform the coordinates from 4326 to 26391 projection using the <code>st_transform()</code> function.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeriaT_sf</span> <span class="op">&lt;-</span> <span class="fu">st_transform</span><span class="op">(</span><span class="va">nigeriaT_sf</span>, crs <span class="op">=</span> <span class="fl">26391</span><span class="op">)</span>

<span class="fu">st_crs</span> <span class="op">(</span><span class="va">nigeria</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:26391 
  wkt:
PROJCRS["Minna / Nigeria West Belt",
    BASEGEOGCRS["Minna",
        DATUM["Minna",
            ELLIPSOID["Clarke 1880 (RGS)",6378249.145,293.465,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4263]],
    CONVERSION["Nigeria West Belt",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",4,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",4.5,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",0.99975,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",230738.26,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",0,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Engineering survey, topographic mapping."],
        AREA["Nigeria - onshore west of 6°30'E, onshore and offshore shelf."],
        BBOX[3.57,2.69,13.9,6.5]],
    ID["EPSG",26391]]</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">st_crs</span> <span class="op">(</span><span class="va">nigeriaT_sf</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:26391 
  wkt:
PROJCRS["Minna / Nigeria West Belt",
    BASEGEOGCRS["Minna",
        DATUM["Minna",
            ELLIPSOID["Clarke 1880 (RGS)",6378249.145,293.465,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4263]],
    CONVERSION["Nigeria West Belt",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",4,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",4.5,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",0.99975,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",230738.26,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",0,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Engineering survey, topographic mapping."],
        AREA["Nigeria - onshore west of 6°30'E, onshore and offshore shelf."],
        BBOX[3.57,2.69,13.9,6.5]],
    ID["EPSG",26391]]</code></pre>
</div>
</div>
<p>Using the <code><a href="https://rdrr.io/r/base/unique.html">unique()</a></code> function, we can identify how many variables are stored within the columns.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span> <span class="op">(</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">usage_capacity</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]  250 1000  300   50</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span> <span class="op">(</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">water_tech</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Tapstand"        "Mechanized Pump" "Hand Pump"       "Unknown"        
[5] "Rope and Bucket"</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span> <span class="op">(</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">status</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Unknown"                          "Functional"                      
[3] "Abandoned/Decommissioned"         "Non-Functional"                  
[5] "Functional but not in use"        "Functional but needs repair"     
[7] "Abandoned"                        "Non functional due to dry season"
[9] "Non-Functional due to dry season"</code></pre>
</div>
</div>
<p>We will also use the <code>st_join()</code> function from the <strong>sf</strong> package to retrieve the <em>shapeName</em> from the <em>polygon</em> geometry based on the <em>point</em> geometry from the attribute file.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeriaT_sf</span> <span class="op">&lt;-</span> <span class="fu">st_join</span><span class="op">(</span><span class="va">nigeriaT_sf</span>,<span class="va">nigeria</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="visualising-of-distribution-using-ggplot" class="level4"><h4 class="anchored" data-anchor-id="visualising-of-distribution-using-ggplot">Visualising of distribution using ggplot</h4>
<p>We will use the <code>ggplot</code> function to visualise the distribution of the different columns. To sort the distribution by descending order <code>fct_infreq</code> will be use.</p>
<section id="distribution-of-status" class="level5"><h5 class="anchored" data-anchor-id="distribution-of-status">Distribution of status</h5>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span> <span class="va">nigeriaT_sf</span>, 
       <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">status</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">status</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">'count'</span>,
           <span class="fu">aes</span><span class="op">(</span>label<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu">stat</span><span class="op">(</span><span class="va">count</span><span class="op">)</span>, <span class="st">', '</span>, 
                             <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">stat</span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu">stat</span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>, 
                             <span class="fl">2</span><span class="op">)</span>, <span class="st">'%'</span><span class="op">)</span><span class="op">)</span>, vjust<span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, size<span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>y<span class="op">=</span> <span class="st">'No. of\nOccurence'</span>, x<span class="op">=</span> <span class="st">'Status'</span>,
       title <span class="op">=</span> <span class="st">"Distribution of Water Tap Status"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.title.y<span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, axis.ticks.x<span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        panel.background<span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, axis.line<span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span>,
        axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="distribution-of-water-technology" class="level5"><h5 class="anchored" data-anchor-id="distribution-of-water-technology">Distribution of Water Technology</h5>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span> <span class="va">nigeriaT_sf</span>, 
       <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">water_tech</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">water_tech</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">'count'</span>,
           <span class="fu">aes</span><span class="op">(</span>label<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu">stat</span><span class="op">(</span><span class="va">count</span><span class="op">)</span>, <span class="st">', '</span>, 
                             <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">stat</span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu">stat</span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>, 
                             <span class="fl">2</span><span class="op">)</span>, <span class="st">'%'</span><span class="op">)</span><span class="op">)</span>, vjust<span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, size<span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>y<span class="op">=</span> <span class="st">'No. of\nOccurence'</span>, x<span class="op">=</span> <span class="st">'Tap Technology'</span>,
       title <span class="op">=</span> <span class="st">"Distribution of Water Tap Technology"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.title.y<span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, axis.ticks.x<span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        panel.background<span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, axis.line<span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span>,
        axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="distribution-of-usage_capacity" class="level5"><h5 class="anchored" data-anchor-id="distribution-of-usage_capacity">Distribution of Usage_Capacity</h5>
<p>Since usage_capacity is in <code>numeric</code>, we will use the <em>as.character()</em> function to convert it into character class before plotting their distribution.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span> <span class="va">nigeriaT_sf</span>, 
       <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">usage_capacity</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">usage_capacity</span><span class="op">)</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">'count'</span>,
           <span class="fu">aes</span><span class="op">(</span>label<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu">stat</span><span class="op">(</span><span class="va">count</span><span class="op">)</span>, <span class="st">', '</span>, 
                             <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">stat</span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu">stat</span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>, 
                             <span class="fl">2</span><span class="op">)</span>, <span class="st">'%'</span><span class="op">)</span><span class="op">)</span>, vjust<span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, size<span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>y<span class="op">=</span> <span class="st">'No. of\nOccurence'</span>, x<span class="op">=</span> <span class="st">'Tap Technology'</span>,
       title <span class="op">=</span> <span class="st">"Distribution of Water Tap Technology"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.title.y<span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, axis.ticks.x<span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        panel.background<span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, axis.line<span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span>,
        axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="distribution-of-rural-water-point" class="level5"><h5 class="anchored" data-anchor-id="distribution-of-rural-water-point">Distribution of Rural Water Point</h5>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span> <span class="va">nigeriaT_sf</span>, 
       <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">is_urban</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">is_urban</span><span class="op">)</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">'count'</span>,
           <span class="fu">aes</span><span class="op">(</span>label<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu">stat</span><span class="op">(</span><span class="va">count</span><span class="op">)</span>, <span class="st">', '</span>, 
                             <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">stat</span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu">stat</span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>, 
                             <span class="fl">2</span><span class="op">)</span>, <span class="st">'%'</span><span class="op">)</span><span class="op">)</span>, vjust<span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, size<span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>y<span class="op">=</span> <span class="st">'No. of\nOccurence'</span>, x<span class="op">=</span> <span class="st">'Urban Water Point?'</span>,
       title <span class="op">=</span> <span class="st">"Distribution of Rural Water Point"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.title.y<span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, axis.ticks.x<span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        panel.background<span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, axis.line<span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span>,
        axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="extracting-status-of-water-point" class="level4"><h4 class="anchored" data-anchor-id="extracting-status-of-water-point">Extracting Status of Water Point</h4>
<p>Since this analysis is on the functionality of the water taps, we have to extract the number of functional and non-functional water taps from the <code>nigeriaT_sf</code> dataframe. The <code>status</code> column reveal the status of the water tap. We will now see what values are recorded by using the <code><a href="https://rdrr.io/r/base/unique.html">unique()</a></code> function. From the result below, we can identify mainly four categories of statuses; <em>Functional</em>, <em>Non-Functional</em>, <em>Abandoned</em>, <em>Unknown</em>.</p>
<p>Note: <strong>For this analysis, abandoned water taps will be analysed under non-functional.</strong></p>
<p>From the result below, we can identify a pattern to classify the status based on our criteria. By extracting the first word of the sentence before the punctuation, we will be able to extract the word; <em>Unknown</em>, <em>Abandoned</em>, <em>Functional</em> and <em>Non</em>. This will assist us in grouping these status.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">status</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Unknown"                          "Functional"                      
[3] "Abandoned/Decommissioned"         "Non-Functional"                  
[5] "Functional but not in use"        "Functional but needs repair"     
[7] "Abandoned"                        "Non functional due to dry season"
[9] "Non-Functional due to dry season"</code></pre>
</div>
</div>
<p>To replace the original values, we will use the <code><a href="https://rdrr.io/r/base/grep.html">gsub()</a></code> function. A regular expression <strong>“([A-Za-z]+).*”</strong> is used to extract all letters and <strong>\\1</strong> is used to back reference the first capturing group. The result below shows the unique values left within the column.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"([A-Za-z]+).*"</span>, <span class="st">"\\1"</span>, <span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">status</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">status</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Unknown"    "Functional" "Abandoned"  "Non"       </code></pre>
</div>
</div>
</section><section id="computing-ratio-of-functional-and-non-functional-water-point" class="level4"><h4 class="anchored" data-anchor-id="computing-ratio-of-functional-and-non-functional-water-point">Computing Ratio of Functional and Non Functional Water Point</h4>
<p>Instead of creating another data frame to store the new values, we will leverage on the filter function by using the single square bracket “[]” operator. The coordinates beings with a row position and that will be used for our filtering condition. <a href="http://www.r-tutor.com/r-introduction/data-frame"><em>R Dataframe</em></a>. Since our water taps are <code>point</code> data, we will use <a href="https://cran.r-project.org/web/packages/sf/vignettes/sf3.html"><code>st_intersects()</code></a> to retrieve every geometry point that intersect with the polygon of the Nigeria ADM area, and subsequently use the function <code><a href="https://rdrr.io/r/base/lengths.html">lengths()</a></code> to retrieve the number of points that intersects with the polygon.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria</span><span class="op">$</span><span class="va">pct_functional</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">[</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">status</span> <span class="op">==</span> <span class="st">"Functional"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">nigeria</span><span class="op">$</span><span class="va">pct_nonfunctional</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">[</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">status</span> <span class="op">==</span> <span class="st">"Non"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">[</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">status</span> <span class="op">==</span> <span class="st">"Abandoned"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">nigeria</span><span class="op">$</span><span class="va">functional</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">[</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">status</span> <span class="op">==</span> <span class="st">"Functional"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">nigeria</span><span class="op">$</span><span class="va">nonfunctional</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">[</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">status</span> <span class="op">==</span> <span class="st">"Non"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">[</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">status</span> <span class="op">==</span> <span class="st">"Abandoned"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">nigeria</span><span class="op">$</span><span class="va">wp_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>,<span class="va">nigeriaT_sf</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="computing-ratio-of-the-different-water-tap-technology" class="level4"><h4 class="anchored" data-anchor-id="computing-ratio-of-the-different-water-tap-technology">Computing Ratio of the Different Water Tap Technology</h4>
<p>Similar to the way we compute the ratio of <code>functional</code> and <code>non-functional</code> water point, we will extract the percentage of the different water technology within each region. We will not compute the percentage of <em>Rope and Bucket</em> since there is only <strong>1</strong> observation and <strong>Unknown</strong> pump technology.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria</span><span class="op">$</span><span class="va">pct_mechpump</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">[</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">water_tech</span> <span class="op">==</span> <span class="st">"Mechanized Pump"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">nigeria</span><span class="op">$</span><span class="va">pct_handpump</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">[</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">water_tech</span> <span class="op">==</span> <span class="st">"Hand Pump"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="computing-ratio-of-the-water-point-utilisation-capacity" class="level4"><h4 class="anchored" data-anchor-id="computing-ratio-of-the-water-point-utilisation-capacity">Computing Ratio of the Water Point Utilisation Capacity</h4>
<p>From the earlier result, we know that there is only 4 unique variables (50, 250, 300 and 1000). But these variables are currently saved as numeric object. Since we want to classify them as a unique identifier rather than a continuous variable, we will convert them to characters using the <code><a href="https://rdrr.io/r/base/character.html">as.character()</a></code> function. Lastly, from the distribution, <code>50</code> does not seem to have too many observations and therefore will be excluded from the analysis. <code>250</code> and <code>300</code> will also be combined to form an object of <code>&lt;1000</code> utilisation.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">usage_capacity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">usage_capacity</span> <span class="op">)</span>
<span class="va">nigeria</span><span class="op">$</span><span class="va">pct_1000M</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">[</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">usage_capacity</span> <span class="op">==</span> <span class="st">"1000"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">nigeria</span><span class="op">$</span><span class="va">pct_1000L</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">[</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">usage_capacity</span> <span class="op">==</span> <span class="st">"300"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">[</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">usage_capacity</span> <span class="op">==</span> <span class="st">"250"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="computing-ratio-of-rural-water-point" class="level4"><h4 class="anchored" data-anchor-id="computing-ratio-of-rural-water-point">Computing Ratio of Rural Water Point</h4>
<p>To extract the ratio of <em>Rural Water Point</em>, we will retrieve the number of water point that <code>is_urban == FALSE</code> and divide by the total number of water point in that region.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria</span><span class="op">$</span><span class="va">pct_rural</span><span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">[</span><span class="va">nigeriaT_sf</span><span class="op">$</span><span class="va">is_urban</span> <span class="op">==</span> <span class="cn">FALSE</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu">st_intersects</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeriaT_sf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="computing-average-percentage-of-overused-water-points" class="level4"><h4 class="anchored" data-anchor-id="computing-average-percentage-of-overused-water-points">Computing Average Percentage of Overused water points</h4>
<p>Overused water point is calculated using the <code>usage_capacity</code> and the <code>water_point_population</code>. We will first compute the pecentage overused for each water point, subsequently, using the <code>group_by</code> and <code>summarise</code> function to retrieve the <code>mean</code> of the overuse percentage by region.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">overuse</span> <span class="op">&lt;-</span> <span class="va">nigeriaT_sf</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span> <span class="op">(</span>pct_overuse <span class="op">=</span> <span class="op">(</span><span class="va">water_point_population</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">usage_capacity</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">shapeName</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span> <span class="op">(</span>avg_pct_overuse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pct_overuse</span><span class="op">)</span><span class="op">)</span>  <span class="op">%&gt;%</span>
  <span class="fu">st_drop_geometry</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will use the <code>left_join()</code> function to join the <code>nigeria</code> dataframe with the <code>overused</code> data. For areas without any water taps, <strong>my assumption</strong> is that these areas do not need water taps for many possible reasons (lack of habitat, urbanised areas, etc), and therefore will be excluded from the analysis. I use the <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> function to remove areas without any water taps and <code>mutate()</code> function to create <em>two</em> new columns that shows the percentage of functional and non-functional water points over the total water point in the area. (Including <code>unknown</code> water point status)</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span>
  <span class="fu">left_join</span><span class="op">(</span><span class="va">overuse</span>,by<span class="op">=</span><span class="st">"shapeName"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span> <span class="op">(</span><span class="va">wp_total</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">wp_total</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We will use the <em>summary</em> function to retrieve statistical information of each column.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  shapeName         pct_functional   pct_nonfunctional   functional    
 Length:761         Min.   :0.0000   Min.   :0.0000    Min.   :  0.00  
 Class :character   1st Qu.:0.3333   1st Qu.:0.2211    1st Qu.: 18.00  
 Mode  :character   Median :0.4792   Median :0.3559    Median : 47.00  
                    Mean   :0.5070   Mean   :0.3654    Mean   : 68.51  
                    3rd Qu.:0.6749   3rd Qu.:0.5082    3rd Qu.: 88.00  
                    Max.   :1.0000   Max.   :1.0000    Max.   :752.00  
 nonfunctional     pct_mechpump     pct_handpump      pct_1000M     
 Min.   :  0.00   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.: 14.00   1st Qu.:0.1250   1st Qu.:0.1860   1st Qu.:0.1250  
 Median : 34.00   Median :0.3193   Median :0.5255   Median :0.3193  
 Mean   : 42.31   Mean   :0.3818   Mean   :0.4956   Mean   :0.3818  
 3rd Qu.: 61.00   3rd Qu.:0.5843   3rd Qu.:0.7857   3rd Qu.:0.5843  
 Max.   :278.00   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
   pct_1000L        pct_rural      avg_pct_overuse            geometry  
 Min.   :0.0000   Min.   :0.0000   Min.   :    0.0   MULTIPOLYGON :761  
 1st Qu.:0.4157   1st Qu.:0.5922   1st Qu.:  182.7   epsg:26391   :  0  
 Median :0.6807   Median :0.8717   Median :  310.7   +proj=tmer...:  0  
 Mean   :0.6182   Mean   :0.7395   Mean   :  511.8                      
 3rd Qu.:0.8750   3rd Qu.:1.0000   3rd Qu.:  587.6                      
 Max.   :1.0000   Max.   :1.0000   Max.   :12064.4                      </code></pre>
</div>
</div>
</section><section id="visualising-column-distribution" class="level4"><h4 class="anchored" data-anchor-id="visualising-column-distribution">Visualising Column Distribution</h4>
<p>To visualise all the distribution easily, we will first use the <code>melt()</code> function from <code>reshape2</code> to convert the data table to <strong>long</strong> format. Next, we will visualise the distribution using a density plot and <code>facet_wrap</code> by each variable. To remove the scientific notation from the axes, we will adjust the scale by inputting <code>labels = scales::comma</code>.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria_density_plot</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span>
  <span class="fu">st_drop_geometry</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">melt</span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">nigeria_density_plot</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_density</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"steelblue"</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scales <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the distribution, we can identify the variables does not conform to Gaussian distribution and we should perform normalization or standardisation before proceeding with our analysis.</p>
</section><section id="variables-collinearity" class="level4"><h4 class="anchored" data-anchor-id="variables-collinearity">Variables Collinearity</h4>
<p>When clustering variables are collinear, certain variables are given more weight than others. Two variables that are highly correlated indicate the same notion. However, because that notion is now represented twice in the data, it receives double the weight of all other variables. The ultimate solution is likely to be tilted toward that notion, which might be a problem if not foreseen. Therefore there is a need to check for <strong>Collinearity</strong> before conducting cluster analysis. We will use the <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> and <code>corrplot.mixed</code> function from the <strong>corrplot</strong> package to visualise and identify highly correlated variables.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria</span><span class="op">$</span><span class="va">functional</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">$</span><span class="va">functional</span><span class="op">)</span>
<span class="va">nigeria</span><span class="op">$</span><span class="va">nonfunctional</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">$</span><span class="va">nonfunctional</span><span class="op">)</span>

<span class="va">nigeria_var</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span>
  <span class="fu">st_drop_geometry</span><span class="op">(</span><span class="op">)</span>

<span class="va">cluster_vars.cor</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">nigeria_var</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span>
<span class="fu">corrplot.mixed</span><span class="op">(</span><span class="va">cluster_vars.cor</span>,
         lower <span class="op">=</span> <span class="st">"ellipse"</span>, 
               upper <span class="op">=</span> <span class="st">"number"</span>,
               tl.pos <span class="op">=</span> <span class="st">"lt"</span>,
               diag <span class="op">=</span> <span class="st">"l"</span>,
               tl.col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the result above, we can identify <strong>4</strong> variables that are highly correlated. We will now choose to only retain <strong>1</strong> (pct_mechpump) for the analysis. We will create another dataframe to store all the variables required for the subsequent cluster analysis.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">pct_handpump</span>, <span class="op">-</span><span class="va">pct_1000M</span>, <span class="op">-</span><span class="va">pct_1000L</span><span class="op">)</span>

<span class="va">nigeria_cluster_var</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span>
  <span class="fu">st_drop_geometry</span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Since the dataframe should only consist of variables used for the clustering, the <code>shapeName</code> should now be an identifier for each row. We will use the <code><a href="https://rdrr.io/r/base/row.names.html">row.names()</a></code> function to set the <code>id</code> for each row using their respective <code>shapeName</code> and remove the <code>shapeName</code> column from the dataframe.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">nigeria_cluster_var</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">nigeria_cluster_var</span><span class="op">$</span><span class="va">shapeName</span>
<span class="va">nigeria_cluster_var</span> <span class="op">&lt;-</span> <span class="fu">select</span><span class="op">(</span><span class="va">nigeria_cluster_var</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="data-normalization" class="level3"><h3 class="anchored" data-anchor-id="data-normalization">Data Normalization</h3>
<p>Larger variances between data points of input variables increases the model’s results’ uncertainty.</p>
<p>Machine learning models assign weights to input variables based on data points and output inferences. If the difference between the data points is large, the model will need to give the points more weight, and the model with a large weight value is generally unstable in the end. This implies that the model may produce bad results or perform poorly during training. Therefore, we will have to ensure our variables are <em>scaled</em> if we were to perform any distance-based algorithm such as K-means Clustering. To scale all the columns, we will use <code>mutate_at()</code> to select all the columns, and perform scaling through the <code><a href="https://rdrr.io/r/base/scale.html">scale()</a></code> function.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria_cluster_var</span> <span class="op">&lt;-</span> <span class="va">nigeria_cluster_var</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate_at</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>, <span class="fu">funs</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="conventional-clustering" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="conventional-clustering">Conventional Clustering</h2>
<section id="hierarchical-clustering" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="hierarchical-clustering">Hierarchical Clustering</h3>
<p>Hierarchical clustering, also known as hierarchical cluster analysis or HCA, is another unsupervised machine learning approach used to sort unlabeled datasets into clusters.</p>
<p>The dendrogram is a tree-shaped structure that we construct in this approach to develop the hierarchy of clusters.</p>
<p>The hierarchical clustering technique has two approaches:</p>
<ul>
<li>
<strong>Agglomerative</strong>: Agglomerative is a bottom-up approach, in which the algorithm starts with taking all data points as single clusters and merging them until one cluster is left.</li>
<li>
<strong>Divisive</strong>: Divisive is a top-down approach, in which the algorithm start with all the data points as one cluster, and slowly seperate them until all data points becomes a single clusters.</li>
</ul>
<section id="computing-of-distance-matrix" class="level4"><h4 class="anchored" data-anchor-id="computing-of-distance-matrix">Computing of Distance Matrix</h4>
<p>We will now create the distance matrix using the <code><a href="https://rdrr.io/r/stats/dist.html">dist()</a></code> function. Since we have multiple dimensions to the data, we will use the <a href="https://bib.dbvis.de/uploadedFiles/155.pdf"><code>Manhattan</code></a> distance to compute the distance matrix instead of the standard <code>Eucluidean</code> distance.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">proxmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">nigeria_cluster_var</span>, method <span class="op">=</span> <span class="st">'manhattan'</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="computing-optimal-hierarchical-clustering-clustering-values" class="level4"><h4 class="anchored" data-anchor-id="computing-optimal-hierarchical-clustering-clustering-values">Computing Optimal Hierarchical Clustering Clustering Values</h4>
<p>We will only use the <code>Gap Statistic Method</code> to determine the optimal cluster. The <code>clusGap()</code> function from the <strong>cluster</strong> package will be used to calculate the goodness of the clustering measure.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">gap_stat</span> <span class="op">&lt;-</span> <span class="fu">clusGap</span><span class="op">(</span><span class="va">nigeria_cluster_var</span>, 
                    FUN <span class="op">=</span> <span class="va">hcut</span>, 
                    nstart <span class="op">=</span> <span class="fl">25</span>, 
                    K.max <span class="op">=</span> <span class="fl">10</span>, 
                    B <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="co"># Print the result</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">gap_stat</span>, method <span class="op">=</span> <span class="st">"firstmax"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Clustering Gap statistic ["clusGap"] from call:
clusGap(x = nigeria_cluster_var, FUNcluster = hcut, K.max = 10,     B = 50, nstart = 25)
B=50 simulated reference sets, k = 1..10; spaceH0="scaledPCA"
 --&gt; Number of clusters (method 'firstmax'): 4
          logW   E.logW      gap      SE.sim
 [1,] 6.470009 7.545740 1.075731 0.007361406
 [2,] 6.361211 7.452901 1.091690 0.012434692
 [3,] 6.269918 7.390535 1.120617 0.012058076
 [4,] 6.185244 7.338807 1.153563 0.010242376
 [5,] 6.155719 7.294504 1.138785 0.010224412
 [6,] 6.106019 7.255521 1.149502 0.009719880
 [7,] 6.067774 7.220190 1.152416 0.009033557
 [8,] 6.027122 7.189133 1.162011 0.008551612
 [9,] 5.986136 7.161042 1.174906 0.008710675
[10,] 5.953721 7.135503 1.181781 0.009210229</code></pre>
</div>
</div>
<p>We will use the <code>fviz_gap_stat()</code> function to visualise the gap statistics results.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">fviz_gap_stat</span><span class="op">(</span><span class="va">gap_stat</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above plot, we can conclude that the optimal number of cluster for the Hierarchical Clustering Algorithm is <strong>4</strong>.</p>
</section><section id="selecting-of-hierarchical-clustering-algorithm" class="level4"><h4 class="anchored" data-anchor-id="selecting-of-hierarchical-clustering-algorithm">Selecting of Hierarchical Clustering Algorithm</h4>
<p>To compute the Hierarchical Cluster, we will use the <code><a href="https://rdrr.io/r/stats/hclust.html">hclust()</a></code> function from R stats. The hclust() uses the Agglomerative approach to compute the cluster. There are 8 different clustering algorithm supported by the function: ward.D, ward.D2, single, complete, average(UPGMA), mcquitty(WPGMA), median(WPGMC) and centroid(UPGMC). To select the optimal algorithm, we will use the <code>agnes()</code> function from the <strong>cluster</strong> package.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">m</span>

<span class="va">ac</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">agnes</span><span class="op">(</span><span class="va">nigeria_cluster_var</span>, method <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">ac</span>
<span class="op">}</span>

<span class="fu">map_dbl</span><span class="op">(</span><span class="va">m</span>, <span class="va">ac</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  average    single  complete      ward 
0.9564875 0.9246884 0.9633398 0.9831761 </code></pre>
</div>
</div>
<p>From the above result, the <em>ward</em> algorithm will produce the optimal cluster coefficient and therefore will be use for this analysis.</p>
</section><section id="computing-of-hierarchical-clustering-and-dendrogram-visualisation" class="level4"><h4 class="anchored" data-anchor-id="computing-of-hierarchical-clustering-and-dendrogram-visualisation">Computing of Hierarchical Clustering and Dendrogram Visualisation</h4>
<p>Using the <code><a href="https://rdrr.io/r/stats/hclust.html">hclust()</a></code> function, we will compute the Hierarchical Cluster and visualise the clusters on a dendrogram using the <code>rect.hclust(</code>) function. Based on the plot below, we can clearly identify 4 cluster but is unable to understand which area belongs to which cluster. We will subsequently use another visualisation method to visualise the output.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">h_clust_ward</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">proxmat</span>, method <span class="op">=</span> <span class="st">'ward.D'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">h_clust_ward</span>, cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/rect.hclust.html">rect.hclust</a></span><span class="op">(</span><span class="va">h_clust_ward</span>, 
            k <span class="op">=</span> <span class="fl">4</span>, 
            border <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="summary-of-hierarchical-cluster" class="level4"><h4 class="anchored" data-anchor-id="summary-of-hierarchical-cluster">Summary of Hierarchical Cluster</h4>
<p>We can conduct a quick summary of the cluster by binding the clusters to the <code>nigeria</code> dataframe using <code><a href="https://rdrr.io/r/base/cbind.html">cbind()</a></code>. To extract the <code>4 cluster</code>, the <code><a href="https://rdrr.io/r/stats/cutree.html">cutree()</a></code> function is used.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">h_clust_ward</span>, k<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">nigeria</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">groups</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">rename</span><span class="op">(</span>`HR_Cluster` <span class="op">=</span> <span class="va">`as.matrix.groups.`</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below generates a quick summary of the average values of all the variables within the cluster.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">HR_Cluster</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise_all</span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 4 features and 9 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 28879.72 ymin: 30292.37 xmax: 1342613 ymax: 1094244
Projected CRS: Minna / Nigeria West Belt
# A tibble: 4 × 10
  HR_Cluster shapeName pct_functional pct_nonfunctional functional nonfunctional
  &lt;chr&gt;          &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt;
1 1                 NA          0.387             0.333       30.9          26.3
2 2                 NA          0.313             0.638       25.3          49.3
3 3                 NA          0.488             0.388       86.9          71.2
4 4                 NA          0.811             0.174      128.           29.0
# … with 4 more variables: pct_mechpump &lt;dbl&gt;, pct_rural &lt;dbl&gt;,
#   avg_pct_overuse &lt;dbl&gt;, geometry &lt;MULTIPOLYGON [m]&gt;</code></pre>
</div>
</div>
</section><section id="visualisation-of-hierarchical-cluster-using-tmap" class="level4"><h4 class="anchored" data-anchor-id="visualisation-of-hierarchical-cluster-using-tmap">Visualisation of Hierarchical Cluster using tmap</h4>
<p>Using the <code>qtm()</code> function, we plot the Nigeria map based on their designated cluster.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">qtm</span><span class="op">(</span><span class="va">nigeria</span>, <span class="st">"HR_Cluster"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="visualisation-of-hierarchical-cluster-using-parallel-coordinates-plot" class="level4 page-columns page-full"><h4 class="anchored" data-anchor-id="visualisation-of-hierarchical-cluster-using-parallel-coordinates-plot">Visualisation of Hierarchical Cluster using Parallel Coordinates Plot</h4>
<p>To better understand the distribution of values based on the different cluster, we will use the <code>ggparcoord()</code> function from the <strong>GGally</strong> package. The <code>ggparcoord()</code> visualisation provide different scaling methods to the variables such as: <em>Min-Max(uniminmax)</em>, <em>Z-Score (std)</em> and many others. For our visualisation, we will be using the <strong>Z-score Normalization</strong> to visualise the distribution of data. The <code>facet_grid()</code> function is used to seperate the different clusters by their grids.</p>
<div class="cell page-columns page-full">
<details><summary>Show the code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">ggparcoord</span><span class="op">(</span><span class="va">nigeria</span>,
    columns <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">8</span>,
    showPoints <span class="op">=</span> <span class="cn">TRUE</span>, 
    title <span class="op">=</span> <span class="st">"Parallel Coordinate Plot for the Nigeria Attributes using Hierarchical Clustering"</span>,
    groupColumn <span class="op">=</span> <span class="st">"HR_Cluster"</span>,
    alphaLines <span class="op">=</span> <span class="fl">0.3</span>,
    scale<span class="op">=</span><span class="st">"std"</span>,
    boxplot <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_color_viridis</span><span class="op">(</span>discrete<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_ipsum</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,
    axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="op">~</span><span class="va">HR_Cluster</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-body-outset">
<p><img src="index_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="1344"></p>
</div>
</div>
</section><section id="interpretation-of-hierarchical-clustering-results" class="level4"><h4 class="anchored" data-anchor-id="interpretation-of-hierarchical-clustering-results">Interpretation of Hierarchical Clustering Results</h4>
<p>Based on the parallel coordinates plot, we can infer that <code>Cluster 2</code> should be an area of concern with a higher average of <code>pct_nonfunctional</code> compare to <code>pct_functional</code>. The next area of concern could be <code>Cluster 1</code> with also a higher average of <code>pct_nonfunctional</code> than <code>pct_functional</code> complemented with a high average of <code>pct_overuse</code>. We will substantiate all the claims in the subsequent section.</p>
</section></section><section id="k-means-clustering" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="k-means-clustering">K-Means Clustering</h3>
<p>K-means clustering is a straightforward unsupervised learning approach for grouping issues. It employs a straightforward approach for categorizing a given data set into a specific number of clusters denoted by the letter “k.” The clusters are then positioned as points, and all observations or data points are associated with the nearest cluster, computed, modified, and the process is repeated until the desired result is obtained. K-Means clustering is also often known as a Partition Clustering Method. We will now analyse the difference between K-means and Hierarchical Clustering.</p>
<section id="computing-optimal-k-means-clustering-values" class="level4"><h4 class="anchored" data-anchor-id="computing-optimal-k-means-clustering-values">Computing Optimal K-Means Clustering Values</h4>
<p>Similar to Hierarchical Clustering, we will use the <code>clusGap()</code> function to obtain the optimal cluster value.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">gap_stat</span> <span class="op">&lt;-</span> <span class="fu">clusGap</span><span class="op">(</span><span class="va">nigeria_cluster_var</span>, FUN <span class="op">=</span> <span class="va">kmeans</span>, nstart <span class="op">=</span> <span class="fl">25</span>,
                    K.max <span class="op">=</span> <span class="fl">12</span>, B <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>

<span class="fu">fviz_gap_stat</span><span class="op">(</span><span class="va">gap_stat</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above plot, we can conclude that the optimal number of cluster for the K-Means Clustering Algorithm is <strong>4</strong>.</p>
</section><section id="computing-of-k-means-clustering" class="level4"><h4 class="anchored" data-anchor-id="computing-of-k-means-clustering">Computing of K-means Clustering</h4>
<p>Using the <code><a href="https://rdrr.io/r/stats/kmeans.html">kmeans()</a></code> function, we will compute the k-means results.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">final_kmeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">nigeria_cluster_var</span>, <span class="fl">4</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="summary-of-k-means-cluster" class="level4"><h4 class="anchored" data-anchor-id="summary-of-k-means-cluster">Summary of K-means Cluster</h4>
<p>We will then have a quick summary on the cluster by first binding the new cluster column to the <code>Nigeria</code> data frame, then the <code>summarise_all</code> function to display the average of each variables based on their cluster.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>KM_Cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">final_kmeans</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below generates a quick summary of the average values of all the variables within the cluster.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">KM_Cluster</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise_all</span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 4 features and 10 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 28879.72 ymin: 30292.37 xmax: 1342613 ymax: 1094244
Projected CRS: Minna / Nigeria West Belt
# A tibble: 4 × 11
  KM_Cluster shapeName pct_functional pct_nonfunctional functional nonfunctional
  &lt;fct&gt;          &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt;
1 1                 NA          0.479             0.240       32.3          17.3
2 2                 NA          0.799             0.177      127.           26.7
3 3                 NA          0.443             0.435       89.8          83.1
4 4                 NA          0.340             0.551       19.9          29.9
# … with 5 more variables: pct_mechpump &lt;dbl&gt;, pct_rural &lt;dbl&gt;,
#   avg_pct_overuse &lt;dbl&gt;, HR_Cluster &lt;dbl&gt;, geometry &lt;MULTIPOLYGON [m]&gt;</code></pre>
</div>
</div>
</section><section id="visualisation-of-k-means-cluster-using-tmap" class="level4"><h4 class="anchored" data-anchor-id="visualisation-of-k-means-cluster-using-tmap">Visualisation of K-means Cluster using tmap</h4>
<p>Using the <code>qtm()</code> function, we plot the Nigeria map based on their designated K-means cluster.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">qtm</span><span class="op">(</span><span class="va">nigeria</span>,fill <span class="op">=</span> <span class="st">"KM_Cluster"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="visualisation-of-k-means-cluster-using-parallel-coordinates-plot" class="level4 page-columns page-full"><h4 class="anchored" data-anchor-id="visualisation-of-k-means-cluster-using-parallel-coordinates-plot">Visualisation of K-means Cluster using Parallel Coordinates Plot</h4>
<p>We will now visualise the variables using the <code>ggparcoord()</code> function.</p>
<div class="cell page-columns page-full">
<details><summary>Show the code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">ggparcoord</span><span class="op">(</span><span class="va">nigeria</span>,
    columns <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">8</span>,
    showPoints <span class="op">=</span> <span class="cn">TRUE</span>, 
    title <span class="op">=</span> <span class="st">"Parallel Coordinate Plot for the Nigeria Attributes"</span>,
    groupColumn <span class="op">=</span> <span class="st">"KM_Cluster"</span>,
    alphaLines <span class="op">=</span> <span class="fl">0.3</span>,
    scale<span class="op">=</span><span class="st">"std"</span>,
    boxplot <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_color_viridis</span><span class="op">(</span>discrete<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_ipsum</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,
    axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="op">~</span><span class="va">KM_Cluster</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-body-outset">
<p><img src="index_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="1344"></p>
</div>
</div>
</section><section id="interpretation-of-k-means-clustering-results" class="level4"><h4 class="anchored" data-anchor-id="interpretation-of-k-means-clustering-results">Interpretation of K-Means Clustering Results</h4>
<p>From the above results, we can <strong>infer</strong> that <strong>Cluster 3</strong> and <strong>Cluster 4</strong> are areas of concerns with a higher average of <em>pct_nonfunctional</em> compared to <em>pct_functional</em>. The most significant difference is that despite having a higher average of <em>pct_overuse</em>, <strong>Cluster 1</strong> have a higher <strong>pct_functional</strong> compared to <strong>pct_nonfunctional</strong>.</p>
</section></section><section id="partitioning-around-medodoids-pam-clustering" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="partitioning-around-medodoids-pam-clustering">Partitioning Around Medodoids (PAM) Clustering</h3>
<p>In order to construct clusters, the PAM algorithm searches a data set for k representative objects (k medoids) and assigns each object to the closest medoid. Its goal is to minimize the sum of dissimilarities between objects in a cluster and the cluster’s center (medoid). It is regarded to be a more robust variant of k-means since it is less sensitive to outliers.</p>
<section id="computing-optimal-pam-clustering-clustering-values" class="level4"><h4 class="anchored" data-anchor-id="computing-optimal-pam-clustering-clustering-values">Computing Optimal PAM Clustering Clustering Values</h4>
<p>Similar to K-means Clustering, we will use the <code>clusGap()</code> function to obtain the optimal cluster value.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>PAM Clustering do not require the nstart component within the clusGap() function.</p>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">gap_stat</span> <span class="op">&lt;-</span> <span class="fu">clusGap</span><span class="op">(</span><span class="va">nigeria_cluster_var</span>, FUN <span class="op">=</span> <span class="va">pam</span>,
                    K.max <span class="op">=</span> <span class="fl">12</span>, B <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>

<span class="fu">fviz_gap_stat</span><span class="op">(</span><span class="va">gap_stat</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above plot, we can conclude that the optimal number of cluster for the PAM Clustering Algorithm is <strong>4</strong>.</p>
</section><section id="computing-of-pam-clustering" class="level4"><h4 class="anchored" data-anchor-id="computing-of-pam-clustering">Computing of PAM Clustering</h4>
<p>Using the <code>pam()</code> function, we will compute the PAM results. Since we have identified earlier to use the <code>manhattan</code> distance instead of <code>euclidean</code> distance, the <code>pam()</code> function require an input on the distance metric using the <code>metric</code> variable. We will also use the <code>manhattan</code> distance metric to compute our PAM cluster.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">final_pam</span> <span class="op">&lt;-</span> <span class="fu">pam</span><span class="op">(</span><span class="va">nigeria_cluster_var</span>, <span class="fl">4</span>, metric <span class="op">=</span> <span class="st">"manhattan"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="summary-of-pam-cluster" class="level4"><h4 class="anchored" data-anchor-id="summary-of-pam-cluster">Summary of PAM Cluster</h4>
<p>We will then have a quick summary on the cluster by first binding the new cluster column to the <code>Nigeria</code> data frame, then the <code>summarise_all</code> function to display the average of each variables based on their cluster.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>PAM_Cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">final_pam</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span>

<span class="va">nigeria</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">PAM_Cluster</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise_all</span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 4 features and 11 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 28879.72 ymin: 30292.37 xmax: 1342613 ymax: 1094244
Projected CRS: Minna / Nigeria West Belt
# A tibble: 4 × 12
  PAM_Cluster shapeName pct_functional pct_nonfunction… functional nonfunctional
  &lt;fct&gt;           &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt;
1 1                  NA          0.437            0.274       26.8          18.1
2 2                  NA          0.326            0.612       19.5          34.5
3 3                  NA          0.796            0.163      127.           25.4
4 4                  NA          0.466            0.424       89.6          78.9
# … with 6 more variables: pct_mechpump &lt;dbl&gt;, pct_rural &lt;dbl&gt;,
#   avg_pct_overuse &lt;dbl&gt;, HR_Cluster &lt;dbl&gt;, geometry &lt;MULTIPOLYGON [m]&gt;,
#   KM_Cluster &lt;dbl&gt;</code></pre>
</div>
</div>
</section><section id="visualisation-of-pam-cluster-using-tmap" class="level4"><h4 class="anchored" data-anchor-id="visualisation-of-pam-cluster-using-tmap">Visualisation of PAM Cluster using tmap</h4>
<p>Using the <code>qtm()</code> function, we plot the Nigeria map based on their designated PAM cluster.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">qtm</span><span class="op">(</span><span class="va">nigeria</span>,fill <span class="op">=</span> <span class="st">"PAM_Cluster"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="visualisation-of-pam-cluster-using-parallel-coordinates-plot" class="level4 page-columns page-full"><h4 class="anchored" data-anchor-id="visualisation-of-pam-cluster-using-parallel-coordinates-plot">Visualisation of PAM Cluster using Parallel Coordinates Plot</h4>
<p>We will now visualise the variables using the <code>ggparcoord()</code> function.</p>
<div class="cell page-columns page-full">
<details><summary>Show the code</summary><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">ggparcoord</span><span class="op">(</span><span class="va">nigeria</span>,
    columns <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">8</span>,
    showPoints <span class="op">=</span> <span class="cn">TRUE</span>, 
    title <span class="op">=</span> <span class="st">"Parallel Coordinate Plot for the Nigeria Attributes"</span>,
    groupColumn <span class="op">=</span> <span class="st">"PAM_Cluster"</span>,
    alphaLines <span class="op">=</span> <span class="fl">0.3</span>,
    scale<span class="op">=</span><span class="st">"std"</span>,
    boxplot <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_color_viridis</span><span class="op">(</span>discrete<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_ipsum</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,
    axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="op">~</span><span class="va">PAM_Cluster</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-body-outset">
<p><img src="index_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="1344"></p>
</div>
</div>
</section><section id="interpretation-of-pam-clustering-results" class="level4"><h4 class="anchored" data-anchor-id="interpretation-of-pam-clustering-results">Interpretation of PAM Clustering Results</h4>
<p>From the above results, we can <strong>infer</strong> that <strong>Cluster 2</strong> and <strong>Cluster 4</strong> are areas of concerns with a higher average of <em>pct_nonfunctional</em> compared to <em>pct_functional</em>. These clusters also have a higher average of <em>pct_rural</em> which could infer that rural water points have <strong>higher percentage</strong> of being not functional. The most significant difference is that despite having a higher average of <em>pct_overuse</em>, <strong>Cluster 1</strong> have a higher <strong>pct_functional</strong> compared to <strong>pct_nonfunctional</strong>.</p>
</section></section><section id="visualisation-of-traditional-clustering-results" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="visualisation-of-traditional-clustering-results">Visualisation of Traditional Clustering Results</h3>
<p>We will now visualise the <code>Nigeria</code> base map with all the different clustering results using <code>tmap</code>. Based on the plot below, we can generally identify that the southern region are the region that are area of concerns based on their <code>pct_nonfunctional</code> and <code>pct_functional</code>. This result is consistent among all the different clustering algorithm.</p>
<div class="cell page-columns page-full">
<details><summary>Show the code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">tmap_mode</span> <span class="op">(</span><span class="st">"plot"</span><span class="op">)</span>
<span class="va">HC_Clust</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span> <span class="op">(</span><span class="va">nigeria</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_polygons</span><span class="op">(</span><span class="st">"HR_Cluster"</span>,
          title <span class="op">=</span> <span class="st">"Hierarchical Cluster"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_layout</span><span class="op">(</span>main.title <span class="op">=</span> <span class="st">"Distribution of Hierarchical Cluster by ADM2"</span>,
            main.title.position <span class="op">=</span> <span class="st">"center"</span>,
            main.title.size <span class="op">=</span> <span class="fl">0.7</span>,
            main.title.fontface <span class="op">=</span> <span class="st">"bold"</span>,
            legend.height <span class="op">=</span> <span class="fl">0.45</span>, 
            legend.width <span class="op">=</span> <span class="fl">0.35</span>,
            frame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="va">K_Clust</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span> <span class="op">(</span><span class="va">nigeria</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_polygons</span><span class="op">(</span><span class="st">"KM_Cluster"</span>,
          title <span class="op">=</span> <span class="st">"K-Means Cluster"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_layout</span><span class="op">(</span>main.title <span class="op">=</span> <span class="st">"Distribution of K-Means Cluster by ADM2"</span>,
            main.title.position <span class="op">=</span> <span class="st">"center"</span>,
            main.title.size <span class="op">=</span> <span class="fl">0.7</span>,
            main.title.fontface <span class="op">=</span> <span class="st">"bold"</span>,
            legend.height <span class="op">=</span> <span class="fl">0.45</span>, 
            legend.width <span class="op">=</span> <span class="fl">0.35</span>,
            frame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="va">PAM_Clust</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span> <span class="op">(</span><span class="va">nigeria</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_polygons</span><span class="op">(</span><span class="st">"PAM_Cluster"</span>,
          title <span class="op">=</span> <span class="st">"PAM Cluster"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_layout</span><span class="op">(</span>main.title <span class="op">=</span> <span class="st">"Distribution of PAM Cluster by ADM2"</span>,
            main.title.position <span class="op">=</span> <span class="st">"center"</span>,
            main.title.size <span class="op">=</span> <span class="fl">0.7</span>,
            main.title.fontface <span class="op">=</span> <span class="st">"bold"</span>,
            legend.height <span class="op">=</span> <span class="fl">0.45</span>, 
            legend.width <span class="op">=</span> <span class="fl">0.35</span>,
            frame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="fu">tmap_arrange</span><span class="op">(</span><span class="va">HC_Clust</span>, <span class="va">K_Clust</span>, <span class="va">PAM_Clust</span>, ncol <span class="op">=</span> <span class="fl">3</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-page">
<p><img src="index_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section></section><section id="spatially-constrainted-clustering" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="spatially-constrainted-clustering">Spatially Constrainted Clustering</h2>
<p>Clustering data is well-trodden territory, and many approaches apply to geographical data as well. The advantage of spatially limited approaches is that it requires spatial objects in the same cluster to be geographically related. This has a number of benefits in real-world applications that require breaking geographies into discrete sections (regionalization), such as building communities, planning areas, amenity zones, logistical units, or even setting up experiments with real-world geographic limits.</p>
<p>In this section, we will explore <strong>3</strong> different spatially constrained clustering algorithm namely:</p>
<ul>
<li>Spatial ’K’luster Analysis by Tree Edge Removal(SKATER)</li>
<li>Spatially Constrained Hierarchical Clustering</li>
<li>Regionalization with Dynamically Constrained Agglomerative clustering and Partitioning (REDCAP)</li>
</ul>
<section id="skater" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="skater">SKATER</h3>
<p>The SKATER algorithm is based on a connectivity graph to express spatial relationships between neighboring regions, with each area represented by a node and edges representing connections between areas. The dissimilarity between neighboring areas is used to compute edge costs.</p>
<section id="retrieving-the-neighbour-list" class="level4"><h4 class="anchored" data-anchor-id="retrieving-the-neighbour-list">Retrieving the neighbour list</h4>
<p>We will use the <a href="https://www.rdocumentation.org/packages/spdep/versions/1.2-7/topics/poly2nb"><code>poly2nb</code></a> function to construct neighbours list based on the regions with contiguous boundaries. Based on the documentation, user will be able to pass a <code>queen</code> argument that takes in True or False. The argument the default is set to TRUE, that is, if you don’t specify queen = FALSE this function will return a list of first order neighbours using the Queen criteria.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria_nb</span> <span class="op">&lt;-</span> <span class="fu">poly2nb</span><span class="op">(</span><span class="va">nigeria</span>, queen<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">nigeria_nb</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 761 
Number of nonzero links: 4348 
Percentage nonzero weights: 0.750793 
Average number of links: 5.713535 
Link number distribution:

  1   2   3   4   5   6   7   8   9  10  11  12  14 
  4  16  57 122 177 137 121  71  39  11   4   1   1 
4 least connected regions:
136 497 513 547 with 1 link
1 most connected region:
496 with 14 links</code></pre>
</div>
</div>
<p>From the summary, we can identify 4 regions with only <strong>1</strong> neighbour and 1 region with <strong>14</strong> neighbours. The average number of neighbours per region is <strong>5</strong>.</p>
</section><section id="retrieving-the-centroid-of-polygon" class="level4"><h4 class="anchored" data-anchor-id="retrieving-the-centroid-of-polygon">Retrieving the Centroid of Polygon</h4>
<p>A connectivity graph takes a point and displays a line to each neighboring point. We are working with polygons at the moment, so we will need to get points in order to make our connectivity graphs. The most typically method for this will be polygon centroids. To retrieve the centroid of each area, we will use the <code>st_centroid</code> function.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu">st_centroid</span><span class="op">(</span><span class="fu">st_geometry</span><span class="op">(</span><span class="va">nigeria</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="visualising-of-neighbours" class="level4"><h4 class="anchored" data-anchor-id="visualising-of-neighbours">Visualising of neighbours</h4>
<p>We will now plot and visualise the neighbours relationship for each region.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">$</span><span class="va">geometry</span>, 
     border<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html">grey</a></span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">nigeria_nb</span>, 
     <span class="va">coords</span>, 
     col<span class="op">=</span><span class="st">"blue"</span>, 
     add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section><section id="computing-edge-cost" class="level4"><h4 class="anchored" data-anchor-id="computing-edge-cost">Computing Edge Cost</h4>
<p>Using the <code>nbcosts()</code> function, we will calculate the distance between each node which is define as the cost of the edge. For each observation, this gives the pairwise dissimilarity between its values on the five variables and the values for the neighbouring observation (from the neighbour list). Basically, this is the notion of a generalised weight for a spatial weights matrix.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">lcosts</span> <span class="op">&lt;-</span> <span class="fu">nbcosts</span><span class="op">(</span><span class="va">nigeria_nb</span>, <span class="va">nigeria_cluster_var</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="computing-neighbour-weights-based-on-edge-cost" class="level4"><h4 class="anchored" data-anchor-id="computing-neighbour-weights-based-on-edge-cost">Computing Neighbour Weights based on Edge Cost</h4>
<p>We will now incorporate the cost into a weights object. This is done by using the <code>nb2listw()</code> function and setting the <code>style</code> to <strong>B</strong>.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria_weight</span> <span class="op">&lt;-</span> <span class="fu">nb2listw</span><span class="op">(</span><span class="va">nigeria_nb</span>, 
                   <span class="va">lcosts</span>, 
                   style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">nigeria_weight</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 761 
Number of nonzero links: 4348 
Percentage nonzero weights: 0.750793 
Average number of links: 5.713535 
Link number distribution:

  1   2   3   4   5   6   7   8   9  10  11  12  14 
  4  16  57 122 177 137 121  71  39  11   4   1   1 
4 least connected regions:
136 497 513 547 with 1 link
1 most connected region:
496 with 14 links

Weights style: B 
Weights constants summary:
    n     nn       S0       S1       S2
B 761 579121 10026.67 62271.18 675249.1</code></pre>
</div>
</div>
</section><section id="computing-minimal-spanning-tree-mst" class="level4"><h4 class="anchored" data-anchor-id="computing-minimal-spanning-tree-mst">Computing Minimal Spanning Tree (MST)</h4>
<p>We will now compute the minimal spanning tree which depicts a fully connected graph with only one neighbour per node. The MST is computed by the <code>mstree()</code> function from the <strong>spdep</strong> package.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria_mst</span> <span class="op">&lt;-</span> <span class="fu">mstree</span><span class="op">(</span><span class="va">nigeria_weight</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">nigeria_mst</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]      [,3]
[1,]  284   43 1.0834428
[2,]  284  297 1.5171722
[3,]  297  185 1.0339759
[4,]  185   15 0.8213166
[5,]   15  322 1.3167224
[6,]  297  586 1.3700931</code></pre>
</div>
</div>
</section><section id="computing-skater-clustering" class="level4"><h4 class="anchored" data-anchor-id="computing-skater-clustering">Computing SKATER clustering</h4>
<p>The code chunk below compute the spatially constrained cluster using <code>skater()</code> of <strong>spdep</strong> package.<br>
The <code>skater()</code> takes three mandatory arguments:</p>
<ul>
<li><p>first two columns of the MST matrix (i.e.&nbsp;not the cost)</p></li>
<li><p>data matrix (to update the costs as units are being grouped)</p></li>
<li><p>number of cuts.</p></li>
</ul>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The cut is set to <strong>one less than the number of clusters</strong>. So, the value specified is not the number of clusters, but the number of cuts in the graph.</p>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">clust4</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/skater.html">skater</a></span><span class="op">(</span>edges <span class="op">=</span> <span class="va">nigeria_mst</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, 
                 data <span class="op">=</span> <span class="va">nigeria_cluster_var</span>, 
                 method <span class="op">=</span> <span class="st">"manhattan"</span>, 
                 ncuts <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="visualisation-of-skater-group-summary" class="level4"><h4 class="anchored" data-anchor-id="visualisation-of-skater-group-summary">Visualisation of SKATER group Summary</h4>
<p>Using the <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> function, we can retrieve the number of areas within each cluster.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ccs4</span> <span class="op">&lt;-</span> <span class="va">clust4</span><span class="op">$</span><span class="va">groups</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ccs4</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>ccs4
  1   2   3   4 
430 120 134  77 </code></pre>
</div>
</div>
</section><section id="summary-of-skater-cluster" class="level4"><h4 class="anchored" data-anchor-id="summary-of-skater-cluster">Summary of SKATER Cluster</h4>
<p>We will then have a quick summary on the cluster by first binding the new cluster column to the <code>Nigeria</code> data frame, then the <code>summarise_all</code> function to display the average of each variables based on their cluster.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">groups_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">clust4</span><span class="op">$</span><span class="va">groups</span><span class="op">)</span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">nigeria</span>, <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">groups_mat</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">rename</span><span class="op">(</span>Skater_Cluster <span class="op">=</span><span class="va">`as.factor.groups_mat.`</span><span class="op">)</span>

<span class="va">nigeria</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Skater_Cluster</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise_all</span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 4 features and 12 fields
Geometry type: GEOMETRY
Dimension:     XY
Bounding box:  xmin: 28879.72 ymin: 30292.37 xmax: 1342613 ymax: 1094244
Projected CRS: Minna / Nigeria West Belt
# A tibble: 4 × 13
  Skater_Cluster shapeName pct_functional pct_nonfunctional functional
  &lt;fct&gt;              &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;      &lt;dbl&gt;
1 1                     NA          0.503             0.390       69.2
2 2                     NA          0.725             0.208      152. 
3 3                     NA          0.339             0.389       16.8
4 4                     NA          0.483             0.430       24.2
# … with 8 more variables: nonfunctional &lt;dbl&gt;, pct_mechpump &lt;dbl&gt;,
#   pct_rural &lt;dbl&gt;, avg_pct_overuse &lt;dbl&gt;, HR_Cluster &lt;dbl&gt;, KM_Cluster &lt;dbl&gt;,
#   PAM_Cluster &lt;dbl&gt;, geometry &lt;GEOMETRY [m]&gt;</code></pre>
</div>
</div>
</section><section id="visualisation-of-skater-cluster-using-tmap" class="level4"><h4 class="anchored" data-anchor-id="visualisation-of-skater-cluster-using-tmap">Visualisation of SKATER Cluster using tmap</h4>
<p>Using the <code>qtm()</code> function, we plot the Nigeria map based on their designated SKATER cluster.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">qtm</span><span class="op">(</span><span class="va">nigeria</span>, <span class="st">"Skater_Cluster"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="visualisation-of-skater-cluster-using-parallel-coordinates-plot" class="level4 page-columns page-full"><h4 class="anchored" data-anchor-id="visualisation-of-skater-cluster-using-parallel-coordinates-plot">Visualisation of SKATER Cluster using Parallel Coordinates Plot</h4>
<p>We will visualise the results using the <code>ggparcoord()</code> function.</p>
<div class="cell page-columns page-full">
<details><summary>Show the code</summary><div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">ggparcoord</span><span class="op">(</span><span class="va">nigeria</span>,
    columns <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">8</span>,
    showPoints <span class="op">=</span> <span class="cn">TRUE</span>, 
    title <span class="op">=</span> <span class="st">"Parallel Coordinate Plot of SKATER for the Nigeria Attributes"</span>,
    groupColumn <span class="op">=</span> <span class="st">"Skater_Cluster"</span>,
    alphaLines <span class="op">=</span> <span class="fl">0.3</span>,
    scale<span class="op">=</span><span class="st">"std"</span>,
    boxplot <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_color_viridis</span><span class="op">(</span>discrete<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_ipsum</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,
    axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="op">~</span><span class="va">Skater_Cluster</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-body-outset">
<p><img src="index_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="1344"></p>
</div>
</div>
</section><section id="interpretation-of-skater-clustering-results" class="level4"><h4 class="anchored" data-anchor-id="interpretation-of-skater-clustering-results">Interpretation of SKATER Clustering Results</h4>
<p>From the above results, we can <strong>infer</strong> that <strong>Cluster 3</strong> and <strong>Cluster 4</strong> are areas of concerns with a higher average of <em>pct_nonfunctional</em> compared to <em>pct_functional</em>. These clusters also have a higher average of <em>pct_overuse</em> and <em>pct_mechpump</em> which could infer that <em>mech pump</em> are placed in areas that areas that have higher population to water point.</p>
</section></section><section id="spatially-constrained-hierarchical-clustering" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="spatially-constrained-hierarchical-clustering">Spatially Constrained Hierarchical Clustering</h3>
<p>In this section, we will conduct Spatially Constrained Hierarchical Clustering using the <code>hclustgeo()</code> function from the <a href="https://cran.r-project.org/web/packages/ClustGeo/vignettes/intro_ClustGeo.html"><code>ClustGeo</code></a> package. The <code>ClustGeo</code> implements a Ward-like hierarchical clustering algorithm including spatial/geographical constraints. It also includes a mixing parameter <span class="math inline">\(\alpha\)</span> that will use to increases the spatial contiguity without deteriorating too much the quality of the solution based on the variables of interest.</p>
<section id="computing-distance-matrix-of-polygon" class="level4"><h4 class="anchored" data-anchor-id="computing-distance-matrix-of-polygon">Computing Distance Matrix of Polygon</h4>
<p>Before we can performed spatially constrained hierarchical clustering, a spatial distance matrix will be derived by using <code>st_distance()</code> from the <strong>sf</strong> package.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>as.dist() instead of as.matrix() is used to convert the data frame into matrix.</p>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu">st_distance</span><span class="op">(</span><span class="va">nigeria</span>, <span class="va">nigeria</span><span class="op">)</span>
<span class="va">distmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="computing-optimal-mixing-parameter" class="level4"><h4 class="anchored" data-anchor-id="computing-optimal-mixing-parameter">Computing Optimal Mixing Parameter</h4>
<p>To retrieve the optimal mixing parameter, we will use the <code>choicealpha()</code> function from <code>ClustGeo</code> package. From the results below, we can see that <span class="math inline">\(\alpha\)</span> <em>0.2</em> produces the</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">cr</span> <span class="op">&lt;-</span> <span class="fu">choicealpha</span><span class="op">(</span><span class="va">proxmat</span>, <span class="va">distmat</span>, range.alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, K<span class="op">=</span><span class="fl">4</span>, graph <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-64-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="computing-of-spatially-constrained-hierarchical-clustering" class="level4"><h4 class="anchored" data-anchor-id="computing-of-spatially-constrained-hierarchical-clustering">Computing of Spatially Constrained Hierarchical Clustering</h4>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">clustG</span> <span class="op">&lt;-</span> <span class="fu">hclustgeo</span><span class="op">(</span><span class="va">proxmat</span>, <span class="va">distmat</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="summary-of-spatially-constrained-hierarchical-cluster" class="level4"><h4 class="anchored" data-anchor-id="summary-of-spatially-constrained-hierarchical-cluster">Summary of Spatially Constrained Hierarchical Cluster</h4>
<p>We will then have a quick summary on the cluster by first binding the new cluster column to the <code>Nigeria</code> data frame, then the <code>summarise_all</code> function to display the average of each variables based on their cluster. Similar to our unconstrained hierarchical cluster, we will use the <code><a href="https://rdrr.io/r/stats/cutree.html">cutree()</a></code> function to retrieve <strong>4</strong> cluster based on the hierarchy.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">clustG</span>, k<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>

<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">nigeria</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">groups</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">rename</span><span class="op">(</span>`HR_Spatial_Cluster` <span class="op">=</span> <span class="va">`as.matrix.groups.`</span><span class="op">)</span>

<span class="va">nigeria</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">HR_Spatial_Cluster</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise_all</span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 4 features and 13 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 28879.72 ymin: 30292.37 xmax: 1342613 ymax: 1094244
Projected CRS: Minna / Nigeria West Belt
# A tibble: 4 × 14
  HR_Spatial_Cluster shapeName pct_functional pct_nonfunctional functional
  &lt;chr&gt;                  &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;      &lt;dbl&gt;
1 1                         NA          0.393             0.393       20.7
2 2                         NA          0.454             0.442       71.4
3 3                         NA          0.806             0.192      175. 
4 4                         NA          0.620             0.232       22.5
# … with 9 more variables: nonfunctional &lt;dbl&gt;, pct_mechpump &lt;dbl&gt;,
#   pct_rural &lt;dbl&gt;, avg_pct_overuse &lt;dbl&gt;, HR_Cluster &lt;dbl&gt;, KM_Cluster &lt;dbl&gt;,
#   PAM_Cluster &lt;dbl&gt;, Skater_Cluster &lt;dbl&gt;, geometry &lt;MULTIPOLYGON [m]&gt;</code></pre>
</div>
</div>
</section><section id="visualisation-of-spatially-constrained-hierarchical-cluster-using-tmap" class="level4"><h4 class="anchored" data-anchor-id="visualisation-of-spatially-constrained-hierarchical-cluster-using-tmap">Visualisation of Spatially Constrained Hierarchical Cluster using tmap</h4>
<p>Using the <code>qtm()</code> function, we plot the Nigeria map based on their designated Hierarchical Cluster.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">qtm</span><span class="op">(</span><span class="va">nigeria</span>, <span class="st">"HR_Spatial_Cluster"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="visualisation-of-spatially-constrained-hierarchical-cluster-using-parallel-coordinates-plot" class="level4 page-columns page-full"><h4 class="anchored" data-anchor-id="visualisation-of-spatially-constrained-hierarchical-cluster-using-parallel-coordinates-plot">Visualisation of Spatially Constrained Hierarchical Cluster using Parallel Coordinates Plot</h4>
<p>We will visualise the results using the <code>ggparcoord()</code> function.</p>
<div class="cell page-columns page-full">
<details><summary>Show the code</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">ggparcoord</span><span class="op">(</span><span class="va">nigeria</span>,
    columns <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">8</span>,
    showPoints <span class="op">=</span> <span class="cn">TRUE</span>, 
    title <span class="op">=</span> <span class="st">"Parallel Coordinate Plot for the Nigeria Attributes"</span>,
    groupColumn <span class="op">=</span> <span class="st">"HR_Spatial_Cluster"</span>,
    alphaLines <span class="op">=</span> <span class="fl">0.3</span>,
    scale<span class="op">=</span><span class="st">"std"</span>,
    boxplot <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_color_viridis</span><span class="op">(</span>discrete<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_ipsum</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,
    axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="op">~</span><span class="va">HR_Spatial_Cluster</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-body-outset">
<p><img src="index_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="1344"></p>
</div>
</div>
</section><section id="interpretation-of-spatially-constrained-hierarchical-cluster-results" class="level4"><h4 class="anchored" data-anchor-id="interpretation-of-spatially-constrained-hierarchical-cluster-results">Interpretation of Spatially Constrained Hierarchical Cluster Results</h4>
<p>From the above results, we can <strong>infer</strong> that <strong>Cluster 1</strong> with a higher average of <em>pct_nonfunctional</em> compared to <em>pct_functional</em> can be deemed as an area of concern. The cluster also have a higher average of <em>pct_overuse</em>. <strong>Cluster 3</strong> and <strong>Cluster 4</strong> are areas that are less of a concern with a higher average of <em>pct_functional</em> than <em>pct_nonfunctional</em>.</p>
</section></section><section id="redcap" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="redcap">REDCAP</h3>
<p>REDCAP starts from building a spanning tree with 4 different ways (<strong>single-linkage</strong>, <strong>average-linkage</strong>, <strong>ward-linkage</strong> and the <strong>complete-linkage</strong>). The single-linkage way leads to build a minimum spanning tree which is similar to SKATER. Then,REDCAP provides 2 different ways (<strong>first-order</strong> and <strong>full-order</strong> constraining) to prune the tree to find clusters. The first-order approach with a minimum spanning tree is exactly the same with SKATER.</p>
<p>In GeoDa and pygeoda, the following methods are provided: <em>First-order and Single-linkage</em>, <em>Full-order and Complete-linkage</em>, <em>Full-order and Average-linkage</em>, <em>Full-order and Single-linkage</em> and <em>Full-order and Ward-linkage</em>.</p>
<p>For this analysis, we will conduct the <strong>Full- Order and Complete-Linkage</strong> approach.</p>
<section id="computing-redcap-cluster" class="level4"><h4 class="anchored" data-anchor-id="computing-redcap-cluster">Computing REDCAP Cluster</h4>
<p>Before we compute the REDCAP cluster, we need to derive the weights in a weights class using the <code>queen_weights()</code> function from the <strong>sf</strong> package. Next we will use the <code>redcap()</code> function from the <strong>sf</strong> package that takes in <strong>4</strong> mandatory inputs:</p>
<ul>
<li>Cluster Size</li>
<li>Weights in Weights class</li>
<li>Dataframe of variables</li>
<li>Approach</li>
</ul>
<p>For this approach, we will analyse with <strong>6</strong> cluster.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">nigeria_weights_sf</span> <span class="op">&lt;-</span> <span class="fu">queen_weights</span><span class="op">(</span><span class="va">nigeria</span><span class="op">)</span>
<span class="va">nigeria_clusters</span>  <span class="op">&lt;-</span> <span class="fu">redcap</span><span class="op">(</span><span class="fl">6</span>, <span class="va">nigeria_weights_sf</span>, <span class="va">nigeria_cluster_var</span>, <span class="st">"fullorder-completelinkage"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Using the <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> function, we can retrieve the number of areas within each cluster.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">nigeria_clusters</span><span class="op">$</span><span class="va">Clusters</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  1   2   3   4   5   6 
405 140 105  92  17   2 </code></pre>
</div>
</div>
</section><section id="summary-of-redcap" class="level4"><h4 class="anchored" data-anchor-id="summary-of-redcap">Summary of REDCAP</h4>
<p>We will then have a quick summary on the cluster by first binding the new cluster column to the <code>Nigeria</code> data frame, then the <code>summarise_all</code> function to display the average of each variables based on their cluster.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">redcap_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">nigeria_clusters</span><span class="op">$</span><span class="va">Clusters</span><span class="op">)</span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">nigeria</span>, <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">redcap_cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">rename</span><span class="op">(</span>`RC_Cluster`<span class="op">=</span><span class="va">`as.factor.redcap_cluster.`</span><span class="op">)</span>

<span class="va">nigeria</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">RC_Cluster</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise_all</span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 14 fields
Geometry type: GEOMETRY
Dimension:     XY
Bounding box:  xmin: 28879.72 ymin: 30292.37 xmax: 1342613 ymax: 1094244
Projected CRS: Minna / Nigeria West Belt
# A tibble: 6 × 15
  RC_Cluster shapeName pct_functional pct_nonfunctional functional nonfunctional
  &lt;fct&gt;          &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt;
1 1                 NA          0.480            0.375        60.8          51.6
2 2                 NA          0.745            0.252       125.           40.9
3 3                 NA          0.291            0.438        15.3          24.8
4 4                 NA          0.457            0.455        18.2          18.4
5 5                 NA          0.831            0.169       401            75.5
6 6                 NA          0.25             0.0625        2             0.5
# … with 9 more variables: pct_mechpump &lt;dbl&gt;, pct_rural &lt;dbl&gt;,
#   avg_pct_overuse &lt;dbl&gt;, HR_Cluster &lt;dbl&gt;, KM_Cluster &lt;dbl&gt;,
#   PAM_Cluster &lt;dbl&gt;, Skater_Cluster &lt;dbl&gt;, HR_Spatial_Cluster &lt;dbl&gt;,
#   geometry &lt;GEOMETRY [m]&gt;</code></pre>
</div>
</div>
</section><section id="visualisation-of-redcap-using-tmap" class="level4"><h4 class="anchored" data-anchor-id="visualisation-of-redcap-using-tmap">Visualisation of REDCAP using tmap</h4>
<p>Using the <code>qtm()</code> function, we plot the Nigeria map based on their designated REDCAP.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">qtm</span><span class="op">(</span><span class="va">nigeria</span>, <span class="st">"RC_Cluster"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="visualisation-of-redcap-using-parallel-coordinates-plot" class="level4 page-columns page-full"><h4 class="anchored" data-anchor-id="visualisation-of-redcap-using-parallel-coordinates-plot">Visualisation of REDCAP using Parallel Coordinates Plot</h4>
<p>We will visualise the results using the <code>ggparcoord()</code> function.</p>
<div class="cell page-columns page-full">
<details><summary>Show the code</summary><div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">ggparcoord</span><span class="op">(</span><span class="va">nigeria</span>,
    columns <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">8</span>,
    showPoints <span class="op">=</span> <span class="cn">TRUE</span>, 
    title <span class="op">=</span> <span class="st">"Parallel Coordinate Plot of REDCAP for the Nigeria Attributes"</span>,
    groupColumn <span class="op">=</span> <span class="st">"RC_Cluster"</span>,
    alphaLines <span class="op">=</span> <span class="fl">0.3</span>,
    scale<span class="op">=</span><span class="st">"std"</span>,
    boxplot <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_color_viridis</span><span class="op">(</span>discrete<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_ipsum</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,
    axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="op">~</span><span class="va">RC_Cluster</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-body-outset">
<p><img src="index_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
</section><section id="interpretation-of-redcap-results" class="level4"><h4 class="anchored" data-anchor-id="interpretation-of-redcap-results">Interpretation of REDCAP Results</h4>
<p>From the above results, we can <strong>infer</strong> that <strong>Cluster 3</strong> and <strong>Cluster 4</strong> with a higher average of <em>pct_nonfunctional</em> compared to <em>pct_functional</em> can be deemed as an area of concern. These cluster also have a higher average of <em>pct_overuse</em> and <em>pct_mechpump</em>. <strong>Cluster 1</strong> and <strong>Cluster 2</strong> are areas that are less of a concern with a higher average of <em>pct_functional</em> than <em>pct_nonfunctional</em>. <strong>Cluster 6</strong> with only 2 observations seems to be an area of concern the highest average of <em>pct_overuse</em>.</p>
</section></section><section id="visualisation-of-spatially-constrained-clustering-results" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="visualisation-of-spatially-constrained-clustering-results">Visualisation of Spatially Constrained Clustering Results</h3>
<p>We will now visualise the <code>Nigeria</code> base map with all the different clustering results using <code>tmap</code>. Based on the plot below, we can generally identify that the southern region are the highlighted as the same cluster and these regions are deemed area of concerns based on their <code>pct_nonfunctional</code> and <code>pct_functional</code> on the earlier results. This result is consistent among all the different spatially clustering algorithm.</p>
<div class="cell page-columns page-full">
<details><summary>Show the code</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">tmap_mode</span> <span class="op">(</span><span class="st">"plot"</span><span class="op">)</span>
<span class="va">SKATER_Clust</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span> <span class="op">(</span><span class="va">nigeria</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_polygons</span><span class="op">(</span><span class="st">"Skater_Cluster"</span>,
          title <span class="op">=</span> <span class="st">"SKATER Cluster"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_layout</span><span class="op">(</span>main.title <span class="op">=</span> <span class="st">"Distribution of SKATER Cluster by ADM2"</span>,
            main.title.position <span class="op">=</span> <span class="st">"center"</span>,
            main.title.size <span class="op">=</span> <span class="fl">0.7</span>,
            main.title.fontface <span class="op">=</span> <span class="st">"bold"</span>,
            legend.height <span class="op">=</span> <span class="fl">0.45</span>, 
            legend.width <span class="op">=</span> <span class="fl">0.35</span>,
            frame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="va">SHC_Clust</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span> <span class="op">(</span><span class="va">nigeria</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_polygons</span><span class="op">(</span><span class="st">"HR_Spatial_Cluster"</span>,
          title <span class="op">=</span> <span class="st">"Spatially Constrained Hierarchical Cluster"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_layout</span><span class="op">(</span>main.title <span class="op">=</span> <span class="st">"Distribution of Spatially Constrained Hierarchical Cluster by ADM2"</span>,
            main.title.position <span class="op">=</span> <span class="st">"center"</span>,
            main.title.size <span class="op">=</span> <span class="fl">0.7</span>,
            main.title.fontface <span class="op">=</span> <span class="st">"bold"</span>,
            legend.height <span class="op">=</span> <span class="fl">0.45</span>, 
            legend.width <span class="op">=</span> <span class="fl">0.35</span>,
            frame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="va">REDCAP_Clust</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span> <span class="op">(</span><span class="va">nigeria</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_polygons</span><span class="op">(</span><span class="st">"RC_Cluster"</span>,
          title <span class="op">=</span> <span class="st">"REDCAP Cluster"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_layout</span><span class="op">(</span>main.title <span class="op">=</span> <span class="st">"Distribution of REDCAP Cluster by ADM2"</span>,
            main.title.position <span class="op">=</span> <span class="st">"center"</span>,
            main.title.size <span class="op">=</span> <span class="fl">0.7</span>,
            main.title.fontface <span class="op">=</span> <span class="st">"bold"</span>,
            legend.height <span class="op">=</span> <span class="fl">0.45</span>, 
            legend.width <span class="op">=</span> <span class="fl">0.35</span>,
            frame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="fu">tmap_arrange</span><span class="op">(</span><span class="va">SKATER_Clust</span>, <span class="va">SHC_Clust</span>, <span class="va">REDCAP_Clust</span>, ncol <span class="op">=</span> <span class="fl">3</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-page">
<p><img src="index_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section></section><section id="interpretation-of-all-the-clustering-results-using-statistical-graph" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="interpretation-of-all-the-clustering-results-using-statistical-graph">Interpretation of all the Clustering Results using Statistical graph</h2>
<section id="visualisation-of-all-the-clustering-results" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="visualisation-of-all-the-clustering-results">Visualisation of all the Clustering Results</h3>
<div class="cell page-columns page-full">
<details><summary>Show the code</summary><div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">tmap_arrange</span><span class="op">(</span><span class="va">HC_Clust</span>, <span class="va">K_Clust</span>, <span class="va">PAM_Clust</span>, <span class="va">SKATER_Clust</span>, <span class="va">SHC_Clust</span>, <span class="va">REDCAP_Clust</span>, ncol <span class="op">=</span> <span class="fl">3</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-page">
<p><img src="index_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section><section id="visualisation-of-all-the-clustering-results-using-statistical-plot" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="visualisation-of-all-the-clustering-results-using-statistical-plot">Visualisation of all the Clustering Results using statistical plot</h3>
<p>Before plotting the statistical plot, we will need to prepare the data frame to be able to group the different clusters as a group. We will have to pivot the dataframe from wide to long using the <code>pivot_longer()</code> function from <code>dpylr</code>. Once we have done that, we will change the class of the <code>Cluster Type</code> to factor and arrange the order of presentation (Traditional Clustering -&gt; Spatially Constrainted Clustering).</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">nigeria_stats</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>
    cols <span class="op">=</span> <span class="op">(</span><span class="fl">9</span><span class="op">:</span><span class="fl">14</span><span class="op">)</span>,
    names_to <span class="op">=</span> <span class="st">"Cluster_Type"</span>,
    values_to <span class="op">=</span> <span class="st">"Cluster_Number"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">st_drop_geometry</span><span class="op">(</span><span class="op">)</span>

<span class="va">nigeria_stats</span><span class="op">$</span><span class="va">Cluster_Type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">nigeria_stats</span><span class="op">$</span><span class="va">Cluster_Type</span>, order <span class="op">=</span> <span class="cn">TRUE</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HR_Cluster"</span>, <span class="st">"KM_Cluster"</span>, <span class="st">"PAM_Cluster"</span>,<span class="st">"Skater_Cluster"</span>,<span class="st">"HR_Spatial_Cluster"</span>,<span class="st">"RC_Cluster"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We will use the <code>grouped_ggbetweenstats()</code> from the <strong>ggstatsplot</strong> package to visualise the distribution of <code>pct_nonfunctional</code> and see if indeed the clusters have higher/lower areas with <code>pct_nonfunctional</code>.</p>
<p>From the plot below, we can see that clustering results from the <strong>traditional clustering</strong> provide better statistical prove that the areas identified earlier through the interpretation of the <code>ggparcoord</code> are statistically significant. Whereas the distribution from the <strong>spatially constrainted clustering</strong> despite having a p-value of &lt; 0.05, not all areas identified above have a significant difference in their <code>pct_nonfunctional</code>.</p>
<div class="cell page-columns page-full">
<details><summary>Show the code</summary><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">grouped_ggbetweenstats</span><span class="op">(</span>
  data             <span class="op">=</span> <span class="va">nigeria_stats</span>,
  x                <span class="op">=</span> <span class="va">Cluster_Number</span>,
  y                <span class="op">=</span> <span class="va">pct_nonfunctional</span>,
  grouping.var     <span class="op">=</span> <span class="va">Cluster_Type</span>,
  p.adjust.method  <span class="op">=</span> <span class="st">"bonferroni"</span>,
  palette          <span class="op">=</span> <span class="st">"default_jama"</span>,
  package          <span class="op">=</span> <span class="st">"ggsci"</span>,
  plotgrid.args    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,
  annotation.args  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Does the Percentage of Non-Functional Water Point Significantly different from each Cluster?"</span><span class="op">)</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-page">
<p><img src="index_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid" width="1344"></p>
</div>
</div>
</section></section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>From our analysis, we can clearly identify the constraint of using <strong>spatially constrainted clustering</strong> with the areas having not so clearly define variables compared to other clusters. Traditional Clustering algorithm still provide better results in clearly defining the areas. But, spatially constrained clustering will be useful if there is a need to have concentrated resources/limited resources in a specific area, and therefore the clusters should be spatially connected instead of sparse.</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><script src="https://giscus.app/client.js" data-repo="jordanong09/ISSS624_Geospatial" data-repo-id="R_kgDOIciwvg" data-category="General" data-category-id="DIC_kwDOIciwvs4CSm3Z" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>